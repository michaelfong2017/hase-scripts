
=============
== PyTorch ==
=============

NVIDIA Release 24.08 (build 107063150)
PyTorch Version 2.5.0a0+872d972
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

ERROR: This container was built for NVIDIA Driver Release 560.35 or later, but
       version 535.161.08 was detected and compatibility mode is UNAVAILABLE.

       [[]]

Looking in links: /cm/shared/python_modules/
Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.51.3)
Requirement already satisfied: accelerate in /usr/local/lib/python3.10/dist-packages (1.7.0)
Requirement already satisfied: deepspeed in /usr/local/lib/python3.10/dist-packages (0.16.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.15.4)
Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.31.4)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.24.4)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.2)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2024.7.24)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.32.3)
Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.21.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.5.3)
Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.66.5)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (6.0.0)
Requirement already satisfied: torch>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.5.0a0+872d972e41.nv24.8)
Requirement already satisfied: hjson in /usr/local/lib/python3.10/dist-packages (from deepspeed) (3.1.0)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.0.8)
Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.11.1.1)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from deepspeed) (9.0.0)
Requirement already satisfied: pydantic>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from deepspeed) (2.8.2)
Requirement already satisfied: nvidia-ml-py in /usr/local/lib/python3.10/dist-packages (from deepspeed) (12.560.30)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (2024.6.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (4.12.2)
Requirement already satisfied: annotated-types>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (0.7.0)
Requirement already satisfied: pydantic-core==2.20.1 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (2.20.1)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=2.0.0->accelerate) (1.3.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2024.7.4)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=2.0.0->accelerate) (2.1.5)
[2025-05-27 13:43:13,598] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/1787/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Configuration loaded from config-qwen-32b-instruct.json
✓ Configuration validation passed
============================================================
LOADED CONFIGURATION
============================================================
📁 Model Configuration:
  Model path: /cm/shared/llm_models/Qwen/Qwen2.5-32B-Instruct
  Model family: qwen

📊 Data Configuration:
  Training data: dataset/train_set.csv
  Evaluation data: dataset/test_set.csv

🔧 LoRA Configuration:
  Use LoRA: False

🚀 Training Configuration:
  Batch size: 1
  Learning rate: 3e-05
  Number of epochs: 3
  Max sequence length: 512
  Gradient accumulation steps: 4
  Warmup steps: 10

💾 Output Configuration:
  Output directory: Auto-generated
============================================================

🖥️  Available GPUs: 6
📁 Output directory: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT

🔍 Initial GPU memory state:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
  GPU 2: 0.00GB allocated, 0.00GB reserved
  GPU 3: 0.00GB allocated, 0.00GB reserved
  GPU 4: 0.00GB allocated, 0.00GB reserved
  GPU 5: 0.00GB allocated, 0.00GB reserved
🔤 Loading tokenizer...
✓ Tokenizer padding side set to: left
📚 Creating datasets...
📊 Loaded 132 examples from dataset/train_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Generated Output', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number']
📊 Loaded 34 examples from dataset/test_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Generated Output', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number']

🔍 After data loading:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
  GPU 2: 0.00GB allocated, 0.00GB reserved
  GPU 3: 0.00GB allocated, 0.00GB reserved
  GPU 4: 0.00GB allocated, 0.00GB reserved
  GPU 5: 0.00GB allocated, 0.00GB reserved
Creating device map for 6 GPUs...
Model has 64 layers
Distributing 64 layers across 6 GPUs
Base layers per GPU: 10
First 4 GPUs will get 1 extra layer
GPU 0: layers 0 to 10 (11 layers)
GPU 1: layers 11 to 21 (11 layers)
GPU 2: layers 22 to 32 (11 layers)
GPU 3: layers 33 to 43 (11 layers)
GPU 4: layers 44 to 53 (10 layers)
GPU 5: layers 54 to 63 (10 layers)
🤖 Loading model with model parallelism...
✓ Model loaded with model parallelism
GPU Memory Usage:
  GPU 0: 11.44GB allocated, 11.44GB reserved
  GPU 1: 9.99GB allocated, 9.99GB reserved
  GPU 2: 9.99GB allocated, 9.99GB reserved
  GPU 3: 9.99GB allocated, 9.99GB reserved
  GPU 4: 9.08GB allocated, 9.08GB reserved
  GPU 5: 10.53GB allocated, 10.54GB reserved
🔧 Using full fine-tuning (no LoRA)

🔍 After model setup:
GPU Memory Usage:
  GPU 0: 11.44GB allocated, 11.44GB reserved
  GPU 1: 9.99GB allocated, 9.99GB reserved
  GPU 2: 9.99GB allocated, 9.99GB reserved
  GPU 3: 9.99GB allocated, 9.99GB reserved
  GPU 4: 9.08GB allocated, 9.08GB reserved
  GPU 5: 10.53GB allocated, 10.54GB reserved
🎯 All model parameters are trainable (full fine-tuning)
📊 Trainable parameters: 32,763,876,352 (100.00%)
🔧 Transformers version: 4.51.3
🔤 Tokenizer Debug Info:
  Vocab size: 151643
  Model max length: 131072
  Available special tokens:
    bos_token: None
    eos_token: '<|im_end|>' (ID: 151645) 🚨 INVALID
    pad_token: '<|endoftext|>' (ID: 151643) 🚨 INVALID
    unk_token: None
  Testing conversation tokens:
    '<|begin_of_text|>': ❌ NOT FOUND
    '<|start_header_id|>': ❌ NOT FOUND
    '<|end_header_id|>': ❌ NOT FOUND
    '<|eot_id|>': ❌ NOT FOUND
    '<|im_start|>': ID 151644 ❌ (broken/invalid)
    '<|im_end|>': ID 151645 ❌ (broken/invalid)
    '<s>': ID 128245 ✅
    '</s>': ID 128247 ✅
    '[INST]': ❌ NOT FOUND
    '[/INST]': ❌ NOT FOUND
    '<|user|>': ❌ NOT FOUND
    '<|assistant|>': ❌ NOT FOUND
    '<|system|>': ❌ NOT FOUND
    'Human:': ❌ NOT FOUND
    'Assistant:': ❌ NOT FOUND
    'User:': ❌ NOT FOUND
    'AI:': ❌ NOT FOUND
  Selected prompt format: plain_text
📊 Number of trainable parameter tensors: 771
📈 Total training steps: 99

============================================================
🚀 STARTING TRAINING
============================================================
  📊 Num examples = 132
  🔄 Num Epochs = 3
  📦 Batch size per device = 1
  📦 Total train batch size = 4
  🔄 Gradient Accumulation steps = 4
  📈 Total optimization steps = 99
============================================================

🔄 === Epoch 1/3 ===
📊 Epoch 1: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.010442
🔄 Batch 1/132: loss=0.010442, scaled=0.002610, accumulated=0.002610
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.010442
🔄 Batch 2/132: loss=0.010442, scaled=0.002610, accumulated=0.005221
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.010442
🔄 Batch 3/132: loss=0.010442, scaled=0.002610, accumulated=0.007831
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000013, scaled=0.000003, accumulated=0.007835
📊 ✅ OPTIMIZATION STEP 1:
    Loss: 0.007835
    LR: 3.00e-06
    Grad norm: 3.000000
    Duration: 6.77s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.010442, scaled=0.002610, accumulated=0.002610
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.010442, scaled=0.002610, accumulated=0.005221
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.010442, scaled=0.002610, accumulated=0.007831
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.061617, scaled=0.015404, accumulated=0.023236
📊 ✅ OPTIMIZATION STEP 2:
    Loss: 0.023236
    LR: 6.00e-06
    Grad norm: 3.593750
    Duration: 0.78s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.007752, scaled=0.001938, accumulated=0.001938
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.000011, scaled=0.000003, accumulated=0.001941
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=0.007044, scaled=0.001761, accumulated=0.003702
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.007044, scaled=0.001761, accumulated=0.005463
📊 ✅ OPTIMIZATION STEP 3:
    Loss: 0.005463
    LR: 9.00e-06
    Grad norm: 1.343750
    Duration: 2.28s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.000602, scaled=0.000150, accumulated=0.000150
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.000666, scaled=0.000166, accumulated=0.000317
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.000666, scaled=0.000166, accumulated=0.000483
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.001151, scaled=0.000288, accumulated=0.000771
📊 ✅ OPTIMIZATION STEP 4:
    Loss: 0.000771
    LR: 1.20e-05
    Grad norm: 0.134766
    Duration: 0.75s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.000084, scaled=0.000021, accumulated=0.000021
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.000073, scaled=0.000018, accumulated=0.000039
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.000045, scaled=0.000011, accumulated=0.000051
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.000003, scaled=0.000001, accumulated=0.000051
📊 ✅ OPTIMIZATION STEP 5:
    Loss: 0.000051
    LR: 1.50e-05
    Grad norm: 0.008789
    Duration: 2.13s
    Batches accumulated: 4
💾 Saving checkpoint at step 5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.000004, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.000001, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.000001, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.000049, scaled=0.000012, accumulated=0.000014
📊 ✅ OPTIMIZATION STEP 6:
    Loss: 0.000014
    LR: 1.80e-05
    Grad norm: 0.002701
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.001598, scaled=0.000400, accumulated=0.000400
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.000000, scaled=0.000000, accumulated=0.000400
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.001598, scaled=0.000400, accumulated=0.000799
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.000009, scaled=0.000002, accumulated=0.000801
📊 ✅ OPTIMIZATION STEP 7:
    Loss: 0.000801
    LR: 2.10e-05
    Grad norm: 0.398438
    Duration: 2.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 8:
    Loss: 0.000000
    LR: 2.40e-05
    Grad norm: 0.000046
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.909704, scaled=0.227426, accumulated=0.227426
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000000, scaled=0.000000, accumulated=0.227426
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.000000, scaled=0.000000, accumulated=0.227426
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.000000, scaled=0.000000, accumulated=0.227426
📊 ✅ OPTIMIZATION STEP 9:
    Loss: 0.227426
    LR: 2.70e-05
    Grad norm: 20.500000
    Duration: 2.29s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.079511, scaled=0.019878, accumulated=0.019878
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.000000, scaled=0.000000, accumulated=0.019878
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000000, scaled=0.000000, accumulated=0.019878
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.000000, scaled=0.000000, accumulated=0.019878
📊 ✅ OPTIMIZATION STEP 10:
    Loss: 0.019878
    LR: 3.00e-05
    Grad norm: 3.453125
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 11:
    Loss: 0.000000
    LR: 2.97e-05
    Grad norm: 0.000033
    Duration: 2.32s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.000040, scaled=0.000010, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.000000, scaled=0.000000, accumulated=0.000010
📊 ✅ OPTIMIZATION STEP 12:
    Loss: 0.000010
    LR: 2.93e-05
    Grad norm: 0.003082
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 13:
    Loss: 0.000000
    LR: 2.90e-05
    Grad norm: 0.000018
    Duration: 2.37s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 14:
    Loss: 0.000000
    LR: 2.87e-05
    Grad norm: 0.000016
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 15:
    Loss: 0.000000
    LR: 2.83e-05
    Grad norm: 0.000034
    Duration: 2.23s
    Batches accumulated: 4
💾 Saving checkpoint at step 15
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 16:
    Loss: 0.000000
    LR: 2.80e-05
    Grad norm: 0.000003
    Duration: 0.75s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 17:
    Loss: 0.000000
    LR: 2.76e-05
    Grad norm: 0.000000
    Duration: 2.16s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000010, scaled=0.000002, accumulated=0.000002
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000000, scaled=0.000000, accumulated=0.000002
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.000000, scaled=0.000000, accumulated=0.000002
📊 ✅ OPTIMIZATION STEP 18:
    Loss: 0.000002
    LR: 2.73e-05
    Grad norm: 0.000755
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000008, scaled=0.000002, accumulated=0.000002
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.000000, scaled=0.000000, accumulated=0.000002
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000000, scaled=0.000000, accumulated=0.000002
📊 ✅ OPTIMIZATION STEP 19:
    Loss: 0.000002
    LR: 2.70e-05
    Grad norm: 0.000648
    Duration: 2.31s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 20:
    Loss: 0.000000
    LR: 2.66e-05
    Grad norm: 0.000003
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 20
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 21:
    Loss: 0.000000
    LR: 2.63e-05
    Grad norm: 0.000013
    Duration: 2.30s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 22:
    Loss: 0.000000
    LR: 2.60e-05
    Grad norm: 0.000017
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 23:
    Loss: 0.000000
    LR: 2.56e-05
    Grad norm: 0.000007
    Duration: 2.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 24:
    Loss: 0.000000
    LR: 2.53e-05
    Grad norm: 0.000000
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 25:
    Loss: 0.000000
    LR: 2.49e-05
    Grad norm: 0.000013
    Duration: 2.31s
    Batches accumulated: 4
💾 Saving checkpoint at step 25
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-15
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.000004, scaled=0.000001, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 26:
    Loss: 0.000001
    LR: 2.46e-05
    Grad norm: 0.000311
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000005, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 27:
    Loss: 0.000001
    LR: 2.43e-05
    Grad norm: 0.000347
    Duration: 2.15s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.000004, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 28:
    Loss: 0.000001
    LR: 2.39e-05
    Grad norm: 0.000273
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 29:
    Loss: 0.000000
    LR: 2.36e-05
    Grad norm: 0.000013
    Duration: 2.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 30:
    Loss: 0.000001
    LR: 2.33e-05
    Grad norm: 0.000243
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 30
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-20
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 31:
    Loss: 0.000000
    LR: 2.29e-05
    Grad norm: 0.000029
    Duration: 2.30s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 32:
    Loss: 0.000000
    LR: 2.26e-05
    Grad norm: 0.000054
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 33:
    Loss: 0.000000
    LR: 2.22e-05
    Grad norm: 0.000000
    Duration: 2.35s
    Batches accumulated: 4

✅ Epoch 1 completed:
    Average loss: 0.002163
    Duration: 2564.3s
    Optimization steps this epoch: 33
    Total optimization steps so far: 33

🔄 === Epoch 2/3 ===
📊 Epoch 2: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 1/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 2/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 3/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 34:
    Loss: 0.000000
    LR: 2.19e-05
    Grad norm: 0.000000
    Duration: 2.17s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 35:
    Loss: 0.000000
    LR: 2.16e-05
    Grad norm: 0.000000
    Duration: 2.17s
    Batches accumulated: 4
💾 Saving checkpoint at step 35
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-25
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 36:
    Loss: 0.000000
    LR: 2.12e-05
    Grad norm: 0.000007
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 37:
    Loss: 0.000000
    LR: 2.09e-05
    Grad norm: 0.000000
    Duration: 2.29s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 38:
    Loss: 0.000000
    LR: 2.06e-05
    Grad norm: 0.000010
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 39:
    Loss: 0.000001
    LR: 2.02e-05
    Grad norm: 0.000214
    Duration: 2.22s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 40:
    Loss: 0.000000
    LR: 1.99e-05
    Grad norm: 0.000010
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 40
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-30
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 41:
    Loss: 0.000001
    LR: 1.96e-05
    Grad norm: 0.000214
    Duration: 2.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 42:
    Loss: 0.000001
    LR: 1.92e-05
    Grad norm: 0.000192
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 43:
    Loss: 0.000000
    LR: 1.89e-05
    Grad norm: 0.000008
    Duration: 2.22s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 44:
    Loss: 0.000000
    LR: 1.85e-05
    Grad norm: 0.000000
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 45:
    Loss: 0.000000
    LR: 1.82e-05
    Grad norm: 0.000016
    Duration: 2.19s
    Batches accumulated: 4
💾 Saving checkpoint at step 45
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-35
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 46:
    Loss: 0.000001
    LR: 1.79e-05
    Grad norm: 0.000214
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 47:
    Loss: 0.000000
    LR: 1.75e-05
    Grad norm: 0.000014
    Duration: 2.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 48:
    Loss: 0.000000
    LR: 1.72e-05
    Grad norm: 0.000010
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 49:
    Loss: 0.000000
    LR: 1.69e-05
    Grad norm: 0.000000
    Duration: 2.10s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 50:
    Loss: 0.000000
    LR: 1.65e-05
    Grad norm: 0.000029
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 50
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-40
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 51:
    Loss: 0.000001
    LR: 1.62e-05
    Grad norm: 0.000194
    Duration: 2.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 52:
    Loss: 0.000000
    LR: 1.58e-05
    Grad norm: 0.000026
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 53:
    Loss: 0.000000
    LR: 1.55e-05
    Grad norm: 0.000010
    Duration: 2.27s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 54:
    Loss: 0.000000
    LR: 1.52e-05
    Grad norm: 0.000001
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 55:
    Loss: 0.000000
    LR: 1.48e-05
    Grad norm: 0.000020
    Duration: 2.32s
    Batches accumulated: 4
💾 Saving checkpoint at step 55
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-45
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 56:
    Loss: 0.000001
    LR: 1.45e-05
    Grad norm: 0.000213
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 57:
    Loss: 0.000000
    LR: 1.42e-05
    Grad norm: 0.000019
    Duration: 2.12s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 58:
    Loss: 0.000000
    LR: 1.38e-05
    Grad norm: 0.000000
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 59:
    Loss: 0.000001
    LR: 1.35e-05
    Grad norm: 0.000191
    Duration: 2.35s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 60:
    Loss: 0.000000
    LR: 1.31e-05
    Grad norm: 0.000002
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 60
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-50
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 61:
    Loss: 0.000001
    LR: 1.28e-05
    Grad norm: 0.000192
    Duration: 2.27s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 62:
    Loss: 0.000000
    LR: 1.25e-05
    Grad norm: 0.000025
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 63:
    Loss: 0.000000
    LR: 1.21e-05
    Grad norm: 0.000000
    Duration: 2.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 64:
    Loss: 0.000000
    LR: 1.18e-05
    Grad norm: 0.000035
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 65:
    Loss: 0.000001
    LR: 1.15e-05
    Grad norm: 0.000192
    Duration: 2.19s
    Batches accumulated: 4
💾 Saving checkpoint at step 65
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-55
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 66:
    Loss: 0.000000
    LR: 1.11e-05
    Grad norm: 0.000015
    Duration: 0.74s
    Batches accumulated: 4

✅ Epoch 2 completed:
    Average loss: 0.000000
    Duration: 2929.1s
    Optimization steps this epoch: 33
    Total optimization steps so far: 66

🔄 === Epoch 3/3 ===
📊 Epoch 3: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 1/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 2/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000000
🔄 Batch 3/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 67:
    Loss: 0.000000
    LR: 1.08e-05
    Grad norm: 0.000000
    Duration: 2.15s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.000002, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 68:
    Loss: 0.000001
    LR: 1.04e-05
    Grad norm: 0.000168
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 69:
    Loss: 0.000000
    LR: 1.01e-05
    Grad norm: 0.000025
    Duration: 2.33s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 70:
    Loss: 0.000000
    LR: 9.78e-06
    Grad norm: 0.000016
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 70
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-60
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 71:
    Loss: 0.000000
    LR: 9.44e-06
    Grad norm: 0.000000
    Duration: 2.23s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 72:
    Loss: 0.000001
    LR: 9.10e-06
    Grad norm: 0.000195
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 73:
    Loss: 0.000000
    LR: 8.76e-06
    Grad norm: 0.000020
    Duration: 2.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 74:
    Loss: 0.000000
    LR: 8.43e-06
    Grad norm: 0.000003
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 75:
    Loss: 0.000000
    LR: 8.09e-06
    Grad norm: 0.000006
    Duration: 2.12s
    Batches accumulated: 4
💾 Saving checkpoint at step 75
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-65
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 76:
    Loss: 0.000000
    LR: 7.75e-06
    Grad norm: 0.000002
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 77:
    Loss: 0.000000
    LR: 7.42e-06
    Grad norm: 0.000012
    Duration: 2.16s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 78:
    Loss: 0.000000
    LR: 7.08e-06
    Grad norm: 0.000005
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 79:
    Loss: 0.000001
    LR: 6.74e-06
    Grad norm: 0.000190
    Duration: 2.24s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 80:
    Loss: 0.000000
    LR: 6.40e-06
    Grad norm: 0.000010
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 80
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-70
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 81:
    Loss: 0.000000
    LR: 6.07e-06
    Grad norm: 0.000000
    Duration: 2.10s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 82:
    Loss: 0.000000
    LR: 5.73e-06
    Grad norm: 0.000028
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 83:
    Loss: 0.000000
    LR: 5.39e-06
    Grad norm: 0.000000
    Duration: 2.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 84:
    Loss: 0.000001
    LR: 5.06e-06
    Grad norm: 0.000195
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 85:
    Loss: 0.000000
    LR: 4.72e-06
    Grad norm: 0.000016
    Duration: 2.46s
    Batches accumulated: 4
💾 Saving checkpoint at step 85
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-75
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 86:
    Loss: 0.000001
    LR: 4.38e-06
    Grad norm: 0.000192
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.000002, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 87:
    Loss: 0.000001
    LR: 4.04e-06
    Grad norm: 0.000168
    Duration: 2.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 88:
    Loss: 0.000000
    LR: 3.71e-06
    Grad norm: 0.000002
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 89:
    Loss: 0.000000
    LR: 3.37e-06
    Grad norm: 0.000013
    Duration: 2.22s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 90:
    Loss: 0.000000
    LR: 3.03e-06
    Grad norm: 0.000013
    Duration: 0.74s
    Batches accumulated: 4
💾 Saving checkpoint at step 90
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-80
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 91:
    Loss: 0.000000
    LR: 2.70e-06
    Grad norm: 0.000000
    Duration: 2.22s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 92:
    Loss: 0.000000
    LR: 2.36e-06
    Grad norm: 0.000000
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 93:
    Loss: 0.000000
    LR: 2.02e-06
    Grad norm: 0.000000
    Duration: 2.19s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 94:
    Loss: 0.000000
    LR: 1.69e-06
    Grad norm: 0.000011
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.000002, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 95:
    Loss: 0.000001
    LR: 1.35e-06
    Grad norm: 0.000167
    Duration: 2.17s
    Batches accumulated: 4
💾 Saving checkpoint at step 95
🗑️ Removing old checkpoint: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/checkpoint-85
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 96:
    Loss: 0.000000
    LR: 1.01e-06
    Grad norm: 0.000010
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
📊 ✅ OPTIMIZATION STEP 97:
    Loss: 0.000000
    LR: 6.74e-07
    Grad norm: 0.000002
    Duration: 2.29s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000002, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 98:
    Loss: 0.000001
    LR: 3.37e-07
    Grad norm: 0.000168
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000002, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000000, scaled=0.000000, accumulated=0.000001
📊 ✅ OPTIMIZATION STEP 99:
    Loss: 0.000001
    LR: 0.00e+00
    Grad norm: 0.000167
    Duration: 2.19s
    Batches accumulated: 4

✅ Epoch 3 completed:
    Average loss: 0.000000
    Duration: 2529.8s
    Optimization steps this epoch: 33
    Total optimization steps so far: 99

🎉 Training completed! Total optimization steps: 99
💾 Saving final model...
✅ Model saved to ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT
🎉 Training and saving completed successfully!

🔍 Final GPU memory state:
GPU Memory Usage:
  GPU 0: 34.55GB allocated, 34.72GB reserved
  GPU 1: 30.06GB allocated, 30.24GB reserved
  GPU 2: 30.06GB allocated, 30.24GB reserved
  GPU 3: 30.06GB allocated, 30.23GB reserved
  GPU 4: 27.33GB allocated, 27.50GB reserved
  GPU 5: 31.68GB allocated, 32.69GB reserved

================================================================================
📊 COMPREHENSIVE TRAINING METRICS REPORT
================================================================================

🎯 TRAINING OVERVIEW
----------------------------------------
📅 Total Training Time: 2:22:23
🔢 Total Training Steps: 99
⚡ Average Step Duration: 1.558 seconds
🚀 Steps per Second: 0.64
📈 Initial Loss: 0.0078
🏁 Final Loss: 0.0000
🎯 Best Loss: 0.0000
📉 Loss Improvement: 0.0078
📊 Loss Improvement: 99.99%

⏱️  STEP TIMING BREAKDOWN
----------------------------------------
🔧 total_training: 142m 23.4s
🔧 data_loading: 0m 0.9s
🔧 model_loading: 0m 14.2s
🔧 lora_setup: 0m 0.0s
🔧 training_setup: 0m 0.0s
🔧 training_loop: 133m 45.0s
🔧 model_saving: 8m 20.9s

💻 RESOURCE UTILIZATION
----------------------------------------
🖥️  Peak CPU Usage: 2.4%
📊 Average CPU Usage: 0.5%

🎮 GPU Memory Usage:
  GPU 0: 34.55 GB (peak)
  GPU 1: 30.06 GB (peak)
  GPU 2: 30.06 GB (peak)
  GPU 3: 30.06 GB (peak)
  GPU 4: 27.33 GB (peak)
  GPU 5: 31.68 GB (peak)

💾 Disk I/O:
  📖 Read: 0.19 GB
  📝 Write: 0.63 GB
  📊 Total: 0.82 GB
================================================================================
📊 Detailed metrics saved to: ./output_models/job_20250527_1343_qwen_Qwen2.5-32B-Instruct_FullFT/training_metrics

==================================================
🎉 MODEL PARALLEL TRAINING COMPLETED SUCCESSFULLY!
==================================================

==================================================
STARTING CLEANUP PROCESS
==================================================
Closing TensorBoard writer...
Clearing model...
Cleanup completed!
==================================================
🧹 All cleanup completed. Exiting.

Program exiting normally...

==================================================
STARTING CLEANUP PROCESS
==================================================
Cleanup completed!
==================================================
Found 0 child processes to terminate
