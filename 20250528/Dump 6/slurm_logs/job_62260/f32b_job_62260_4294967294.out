
=============
== PyTorch ==
=============

NVIDIA Release 24.08 (build 107063150)
PyTorch Version 2.5.0a0+872d972
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

ERROR: This container was built for NVIDIA Driver Release 560.35 or later, but
       version 535.161.08 was detected and compatibility mode is UNAVAILABLE.

       [[]]

Looking in links: /cm/shared/python_modules/
Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.51.3)
Requirement already satisfied: accelerate in /usr/local/lib/python3.10/dist-packages (1.7.0)
Requirement already satisfied: deepspeed in /usr/local/lib/python3.10/dist-packages (0.16.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.15.4)
Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.31.4)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.24.4)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.2)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2024.7.24)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.32.3)
Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.21.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.5.3)
Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.66.5)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (6.0.0)
Requirement already satisfied: torch>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.5.0a0+872d972e41.nv24.8)
Requirement already satisfied: hjson in /usr/local/lib/python3.10/dist-packages (from deepspeed) (3.1.0)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.0.8)
Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.11.1.1)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from deepspeed) (9.0.0)
Requirement already satisfied: pydantic>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from deepspeed) (2.8.2)
Requirement already satisfied: nvidia-ml-py in /usr/local/lib/python3.10/dist-packages (from deepspeed) (12.560.30)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (2024.6.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (4.12.2)
Requirement already satisfied: annotated-types>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (0.7.0)
Requirement already satisfied: pydantic-core==2.20.1 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (2.20.1)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=2.0.0->accelerate) (1.3.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2024.7.4)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=2.0.0->accelerate) (2.1.5)
[2025-05-27 20:58:01,764] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/1787/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Configuration loaded from config-qwen-32b-instruct-lora.json
✓ Configuration validation passed
============================================================
LOADED CONFIGURATION
============================================================
📁 Model Configuration:
  Model path: /cm/shared/llm_models/Qwen/Qwen2.5-32B-Instruct
  Model family: qwen

📊 Data Configuration:
  Training data: dataset/train_set.csv
  Evaluation data: dataset/test_set.csv

🔧 LoRA Configuration:
  Use LoRA: True
  LoRA rank: 32
  LoRA alpha: 32
  LoRA dropout: 0.05

🚀 Training Configuration:
  Batch size: 1
  Learning rate: 3e-05
  Number of epochs: 3
  Max sequence length: 512
  Gradient accumulation steps: 4
  Warmup steps: 10

💾 Output Configuration:
  Output directory: Auto-generated
============================================================

🖥️  Available GPUs: 2
📁 Output directory: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA

🔍 Initial GPU memory state:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
🔤 Loading tokenizer...
✓ Tokenizer padding side set to: left
📚 Creating datasets...
📊 Loaded 132 examples from dataset/train_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Generated Output', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number']
📊 Loaded 34 examples from dataset/test_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Generated Output', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number']

🔍 After data loading:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
Creating device map for 2 GPUs...
Model has 64 layers
Distributing 64 layers across 2 GPUs
Base layers per GPU: 32
GPU 0: layers 0 to 31 (32 layers)
GPU 1: layers 32 to 63 (32 layers)
🤖 Loading model with model parallelism...
✓ Model loaded with model parallelism
GPU Memory Usage:
  GPU 0: 30.51GB allocated, 30.52GB reserved
  GPU 1: 30.51GB allocated, 30.52GB reserved
🔧 Applying LoRA...
✓ LoRA target modules for qwen: ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'gate_proj', 'up_proj', 'down_proj']

🔍 After LoRA application:
GPU Memory Usage:
  GPU 0: 31.01GB allocated, 31.09GB reserved
  GPU 1: 31.01GB allocated, 31.09GB reserved
🎯 LoRA parameters found: 896
📊 Trainable parameters: 268,435,456 (0.81%)
🔧 Transformers version: 4.51.3
🔤 Tokenizer Debug Info:
  Vocab size: 151643
  Model max length: 131072
  Available special tokens:
    bos_token: None
    eos_token: '<|im_end|>' (ID: 151645) 🚨 INVALID
    pad_token: '<|endoftext|>' (ID: 151643) 🚨 INVALID
    unk_token: None
  Testing conversation tokens:
    '<|begin_of_text|>': ❌ NOT FOUND
    '<|start_header_id|>': ❌ NOT FOUND
    '<|end_header_id|>': ❌ NOT FOUND
    '<|eot_id|>': ❌ NOT FOUND
    '<|im_start|>': ID 151644 ❌ (broken/invalid)
    '<|im_end|>': ID 151645 ❌ (broken/invalid)
    '<s>': ID 128245 ✅
    '</s>': ID 128247 ✅
    '[INST]': ❌ NOT FOUND
    '[/INST]': ❌ NOT FOUND
    '<|user|>': ❌ NOT FOUND
    '<|assistant|>': ❌ NOT FOUND
    '<|system|>': ❌ NOT FOUND
    'Human:': ❌ NOT FOUND
    'Assistant:': ❌ NOT FOUND
    'User:': ❌ NOT FOUND
    'AI:': ❌ NOT FOUND
  Selected prompt format: plain_text
📊 Number of trainable parameter tensors: 896
📈 Total training steps: 99

============================================================
🚀 STARTING TRAINING
============================================================
  📊 Num examples = 132
  🔄 Num Epochs = 3
  📦 Batch size per device = 1
  📦 Total train batch size = 4
  🔄 Gradient Accumulation steps = 4
  📈 Total optimization steps = 99
============================================================

🔄 === Epoch 1/3 ===
📊 Epoch 1: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.010442
🔄 Batch 1/132: loss=0.010442, scaled=0.002610, accumulated=0.002610
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.017710
🔄 Batch 2/132: loss=0.017710, scaled=0.004427, accumulated=0.007038
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.061617
🔄 Batch 3/132: loss=0.061617, scaled=0.015404, accumulated=0.022442
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000013, scaled=0.000003, accumulated=0.022445
📊 ✅ OPTIMIZATION STEP 1:
    Loss: 0.022445
    LR: 3.00e-06
    Grad norm: 0.099925
    Duration: 1.23s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.017710, scaled=0.004427, accumulated=0.004427
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.000013, scaled=0.000003, accumulated=0.004431
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.017710, scaled=0.004427, accumulated=0.008858
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.010442, scaled=0.002610, accumulated=0.011469
📊 ✅ OPTIMIZATION STEP 2:
    Loss: 0.011469
    LR: 6.00e-06
    Grad norm: 0.089989
    Duration: 0.05s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.011959, scaled=0.002990, accumulated=0.002990
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.010653, scaled=0.002663, accumulated=0.005653
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=1.025916, scaled=0.256479, accumulated=0.262132
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.011369, scaled=0.002842, accumulated=0.264974
📊 ✅ OPTIMIZATION STEP 3:
    Loss: 0.264974
    LR: 9.00e-06
    Grad norm: 0.398538
    Duration: 0.36s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.016270, scaled=0.004068, accumulated=0.004068
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.011378, scaled=0.002845, accumulated=0.006912
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.008405, scaled=0.002101, accumulated=0.009013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.011293, scaled=0.002823, accumulated=0.011836
📊 ✅ OPTIMIZATION STEP 4:
    Loss: 0.011836
    LR: 1.20e-05
    Grad norm: 0.089319
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.017876, scaled=0.004469, accumulated=0.004469
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.011395, scaled=0.002849, accumulated=0.007318
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.011365, scaled=0.002841, accumulated=0.010159
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.017702, scaled=0.004425, accumulated=0.014584
📊 ✅ OPTIMIZATION STEP 5:
    Loss: 0.014584
    LR: 1.50e-05
    Grad norm: 0.115114
    Duration: 0.20s
    Batches accumulated: 4
💾 Saving checkpoint at step 5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.007448, scaled=0.001862, accumulated=0.001862
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.016035, scaled=0.004009, accumulated=0.005871
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.011131, scaled=0.002783, accumulated=0.008653
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.066192, scaled=0.016548, accumulated=0.025201
📊 ✅ OPTIMIZATION STEP 6:
    Loss: 0.025201
    LR: 1.80e-05
    Grad norm: 0.109272
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.012807, scaled=0.003202, accumulated=0.003202
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.007879, scaled=0.001970, accumulated=0.005171
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.010146, scaled=0.002537, accumulated=0.007708
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.000015, scaled=0.000004, accumulated=0.007712
📊 ✅ OPTIMIZATION STEP 7:
    Loss: 0.007712
    LR: 2.10e-05
    Grad norm: 0.043797
    Duration: 0.33s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000930, scaled=0.000233, accumulated=0.000233
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.014468, scaled=0.003617, accumulated=0.003850
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000014, scaled=0.000004, accumulated=0.003853
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.014436, scaled=0.003609, accumulated=0.007462
📊 ✅ OPTIMIZATION STEP 8:
    Loss: 0.007462
    LR: 2.40e-05
    Grad norm: 0.058246
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.012331, scaled=0.003083, accumulated=0.003083
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000913, scaled=0.000228, accumulated=0.003311
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.057864, scaled=0.014466, accumulated=0.017777
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.012398, scaled=0.003099, accumulated=0.020877
📊 ✅ OPTIMIZATION STEP 9:
    Loss: 0.020877
    LR: 2.70e-05
    Grad norm: 0.101139
    Duration: 0.27s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.000904, scaled=0.000226, accumulated=0.000226
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.006320, scaled=0.001580, accumulated=0.001806
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000011, scaled=0.000003, accumulated=0.001809
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.009777, scaled=0.002444, accumulated=0.004253
📊 ✅ OPTIMIZATION STEP 10:
    Loss: 0.004253
    LR: 3.00e-05
    Grad norm: 0.026882
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=1.003028, scaled=0.250757, accumulated=0.250757
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.006331, scaled=0.001583, accumulated=0.252340
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000008, scaled=0.000002, accumulated=0.252342
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.004381, scaled=0.001095, accumulated=0.253437
📊 ✅ OPTIMIZATION STEP 11:
    Loss: 0.253437
    LR: 2.97e-05
    Grad norm: 0.389705
    Duration: 0.36s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.003402, scaled=0.000850, accumulated=0.000850
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.006125, scaled=0.001531, accumulated=0.002382
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.003058, scaled=0.000764, accumulated=0.003146
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.011549, scaled=0.002887, accumulated=0.006033
📊 ✅ OPTIMIZATION STEP 12:
    Loss: 0.006033
    LR: 2.93e-05
    Grad norm: 0.036611
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000842, scaled=0.000210, accumulated=0.000210
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.004351, scaled=0.001088, accumulated=0.001298
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.004392, scaled=0.001098, accumulated=0.002396
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.004217, scaled=0.001054, accumulated=0.003450
📊 ✅ OPTIMIZATION STEP 13:
    Loss: 0.003450
    LR: 2.90e-05
    Grad norm: 0.023982
    Duration: 0.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.004545, scaled=0.001136, accumulated=0.001136
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.001854, scaled=0.000463, accumulated=0.001600
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.027858, scaled=0.006964, accumulated=0.008564
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.003433, scaled=0.000858, accumulated=0.009422
📊 ✅ OPTIMIZATION STEP 14:
    Loss: 0.009422
    LR: 2.87e-05
    Grad norm: 0.057274
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.001470, scaled=0.000368, accumulated=0.000368
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.006392, scaled=0.001598, accumulated=0.001966
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.002499, scaled=0.000625, accumulated=0.002590
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.002600, scaled=0.000650, accumulated=0.003240
📊 ✅ OPTIMIZATION STEP 15:
    Loss: 0.003240
    LR: 2.83e-05
    Grad norm: 0.040258
    Duration: 0.29s
    Batches accumulated: 4
💾 Saving checkpoint at step 15
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000009, scaled=0.000002, accumulated=0.000002
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.015082, scaled=0.003770, accumulated=0.003773
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.001195, scaled=0.000299, accumulated=0.004072
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.000009, scaled=0.000002, accumulated=0.004074
📊 ✅ OPTIMIZATION STEP 16:
    Loss: 0.004074
    LR: 2.80e-05
    Grad norm: 0.030061
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.003008, scaled=0.000752, accumulated=0.000752
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.001507, scaled=0.000377, accumulated=0.001129
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000920, scaled=0.000230, accumulated=0.001359
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.001455, scaled=0.000364, accumulated=0.001722
📊 ✅ OPTIMIZATION STEP 17:
    Loss: 0.001722
    LR: 2.76e-05
    Grad norm: 0.012176
    Duration: 0.19s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.745527, scaled=0.186382, accumulated=0.186382
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000734, scaled=0.000183, accumulated=0.186565
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000672, scaled=0.000168, accumulated=0.186733
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.001222, scaled=0.000306, accumulated=0.187039
📊 ✅ OPTIMIZATION STEP 18:
    Loss: 0.187039
    LR: 2.73e-05
    Grad norm: 0.449263
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000599, scaled=0.000150, accumulated=0.000150
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000008, scaled=0.000002, accumulated=0.000152
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.006540, scaled=0.001635, accumulated=0.001787
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000886, scaled=0.000221, accumulated=0.002008
📊 ✅ OPTIMIZATION STEP 19:
    Loss: 0.002008
    LR: 2.70e-05
    Grad norm: 0.014995
    Duration: 0.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.007433, scaled=0.001858, accumulated=0.001858
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.001932, scaled=0.000483, accumulated=0.002341
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.568425, scaled=0.142106, accumulated=0.144448
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000704, scaled=0.000176, accumulated=0.144624
📊 ✅ OPTIMIZATION STEP 20:
    Loss: 0.144624
    LR: 2.66e-05
    Grad norm: 0.412444
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 20
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000402, scaled=0.000100, accumulated=0.000100
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000007, scaled=0.000002, accumulated=0.000102
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.472075, scaled=0.118019, accumulated=0.118121
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.002430, scaled=0.000608, accumulated=0.118728
📊 ✅ OPTIMIZATION STEP 21:
    Loss: 0.118728
    LR: 2.63e-05
    Grad norm: 0.372338
    Duration: 0.37s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.001457, scaled=0.000364, accumulated=0.000364
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.003348, scaled=0.000837, accumulated=0.001201
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000326, scaled=0.000082, accumulated=0.001283
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000437, scaled=0.000109, accumulated=0.001392
📊 ✅ OPTIMIZATION STEP 22:
    Loss: 0.001392
    LR: 2.60e-05
    Grad norm: 0.009357
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.006022, scaled=0.001506, accumulated=0.001506
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000401, scaled=0.000100, accumulated=0.001606
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000296, scaled=0.000074, accumulated=0.001680
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000272, scaled=0.000068, accumulated=0.001748
📊 ✅ OPTIMIZATION STEP 23:
    Loss: 0.001748
    LR: 2.56e-05
    Grad norm: 0.017710
    Duration: 0.35s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000309, scaled=0.000077, accumulated=0.000077
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.213987, scaled=0.053497, accumulated=0.053574
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000302, scaled=0.000076, accumulated=0.053650
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000324, scaled=0.000081, accumulated=0.053731
📊 ✅ OPTIMIZATION STEP 24:
    Loss: 0.053731
    LR: 2.53e-05
    Grad norm: 0.220233
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000207, scaled=0.000052, accumulated=0.000052
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000260, scaled=0.000065, accumulated=0.000117
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000210, scaled=0.000052, accumulated=0.000169
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000264, scaled=0.000066, accumulated=0.000235
📊 ✅ OPTIMIZATION STEP 25:
    Loss: 0.000235
    LR: 2.49e-05
    Grad norm: 0.002208
    Duration: 0.37s
    Batches accumulated: 4
💾 Saving checkpoint at step 25
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-15
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000220, scaled=0.000055, accumulated=0.000055
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000182, scaled=0.000046, accumulated=0.000101
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000004, scaled=0.000001, accumulated=0.000102
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.125854, scaled=0.031464, accumulated=0.031565
📊 ✅ OPTIMIZATION STEP 26:
    Loss: 0.031565
    LR: 2.46e-05
    Grad norm: 0.157321
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000180, scaled=0.000045, accumulated=0.000045
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000150, scaled=0.000038, accumulated=0.000082
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000451, scaled=0.000113, accumulated=0.000195
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000145, scaled=0.000036, accumulated=0.000231
📊 ✅ OPTIMIZATION STEP 27:
    Loss: 0.000231
    LR: 2.43e-05
    Grad norm: 0.001870
    Duration: 0.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.003760, scaled=0.000940, accumulated=0.000940
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.001250, scaled=0.000313, accumulated=0.001253
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.004033, scaled=0.001008, accumulated=0.002261
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000138, scaled=0.000035, accumulated=0.002295
📊 ✅ OPTIMIZATION STEP 28:
    Loss: 0.002295
    LR: 2.39e-05
    Grad norm: 0.029411
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.058331, scaled=0.014583, accumulated=0.014583
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.059064, scaled=0.014766, accumulated=0.029349
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000123, scaled=0.000031, accumulated=0.029380
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000003, scaled=0.000001, accumulated=0.029380
📊 ✅ OPTIMIZATION STEP 29:
    Loss: 0.029380
    LR: 2.36e-05
    Grad norm: 0.174578
    Duration: 0.39s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000103, scaled=0.000026, accumulated=0.000026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000580, scaled=0.000145, accumulated=0.000171
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000110, scaled=0.000027, accumulated=0.000198
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000987, scaled=0.000247, accumulated=0.000445
📊 ✅ OPTIMIZATION STEP 30:
    Loss: 0.000445
    LR: 2.33e-05
    Grad norm: 0.005010
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 30
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-20
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000003, scaled=0.000001, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000095, scaled=0.000024, accumulated=0.000024
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.002802, scaled=0.000701, accumulated=0.000725
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000835, scaled=0.000209, accumulated=0.000934
📊 ✅ OPTIMIZATION STEP 31:
    Loss: 0.000934
    LR: 2.29e-05
    Grad norm: 0.011351
    Duration: 0.31s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000476, scaled=0.000119, accumulated=0.000119
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000092, scaled=0.000023, accumulated=0.000142
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000083, scaled=0.000021, accumulated=0.000163
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000094, scaled=0.000024, accumulated=0.000186
📊 ✅ OPTIMIZATION STEP 32:
    Loss: 0.000186
    LR: 2.26e-05
    Grad norm: 0.002521
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000076, scaled=0.000019, accumulated=0.000019
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000707, scaled=0.000177, accumulated=0.000196
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000078, scaled=0.000019, accumulated=0.000215
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000084, scaled=0.000021, accumulated=0.000236
📊 ✅ OPTIMIZATION STEP 33:
    Loss: 0.000236
    LR: 2.22e-05
    Grad norm: 0.002508
    Duration: 0.29s
    Batches accumulated: 4

✅ Epoch 1 completed:
    Average loss: 0.009447
    Duration: 169.5s
    Optimization steps this epoch: 33
    Total optimization steps so far: 33

🔄 === Epoch 2/3 ===
📊 Epoch 2: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000074
🔄 Batch 1/132: loss=0.000074, scaled=0.000018, accumulated=0.000018
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000075
🔄 Batch 2/132: loss=0.000075, scaled=0.000019, accumulated=0.000037
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000069
🔄 Batch 3/132: loss=0.000069, scaled=0.000017, accumulated=0.000054
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000070, scaled=0.000017, accumulated=0.000072
📊 ✅ OPTIMIZATION STEP 34:
    Loss: 0.000072
    LR: 2.19e-05
    Grad norm: 0.000918
    Duration: 0.25s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.000324, scaled=0.000081, accumulated=0.000081
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.000240, scaled=0.000060, accumulated=0.000141
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.000065, scaled=0.000016, accumulated=0.000157
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.000067, scaled=0.000017, accumulated=0.000174
📊 ✅ OPTIMIZATION STEP 35:
    Loss: 0.000174
    LR: 2.16e-05
    Grad norm: 0.002889
    Duration: 0.23s
    Batches accumulated: 4
💾 Saving checkpoint at step 35
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-25
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.000062, scaled=0.000016, accumulated=0.000016
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.000061, scaled=0.000015, accumulated=0.000031
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=0.000054, scaled=0.000014, accumulated=0.000044
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.000002, scaled=0.000000, accumulated=0.000045
📊 ✅ OPTIMIZATION STEP 36:
    Loss: 0.000045
    LR: 2.12e-05
    Grad norm: 0.000561
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.000446, scaled=0.000111, accumulated=0.000111
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.000055, scaled=0.000014, accumulated=0.000125
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.000232, scaled=0.000058, accumulated=0.000183
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.000229, scaled=0.000057, accumulated=0.000240
📊 ✅ OPTIMIZATION STEP 37:
    Loss: 0.000240
    LR: 2.09e-05
    Grad norm: 0.003641
    Duration: 0.23s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.000172, scaled=0.000043, accumulated=0.000043
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.000049, scaled=0.000012, accumulated=0.000055
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.007085, scaled=0.001771, accumulated=0.001826
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.000052, scaled=0.000013, accumulated=0.001840
📊 ✅ OPTIMIZATION STEP 38:
    Loss: 0.001840
    LR: 2.06e-05
    Grad norm: 0.018536
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.000181, scaled=0.000045, accumulated=0.000045
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.000001, scaled=0.000000, accumulated=0.000046
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.000049, scaled=0.000012, accumulated=0.000058
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.000048, scaled=0.000012, accumulated=0.000070
📊 ✅ OPTIMIZATION STEP 39:
    Loss: 0.000070
    LR: 2.02e-05
    Grad norm: 0.001041
    Duration: 0.29s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.000152, scaled=0.000038, accumulated=0.000038
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.005203, scaled=0.001301, accumulated=0.001339
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.000182, scaled=0.000045, accumulated=0.001384
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.005279, scaled=0.001320, accumulated=0.002704
📊 ✅ OPTIMIZATION STEP 40:
    Loss: 0.002704
    LR: 1.99e-05
    Grad norm: 0.029611
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 40
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-30
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000001, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.000001, scaled=0.000000, accumulated=0.000001
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000448, scaled=0.000112, accumulated=0.000112
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.000041, scaled=0.000010, accumulated=0.000123
📊 ✅ OPTIMIZATION STEP 41:
    Loss: 0.000123
    LR: 1.96e-05
    Grad norm: 0.001400
    Duration: 0.24s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.000143, scaled=0.000036, accumulated=0.000036
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000044, scaled=0.000011, accumulated=0.000047
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.000042, scaled=0.000010, accumulated=0.000057
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.000001, scaled=0.000000, accumulated=0.000057
📊 ✅ OPTIMIZATION STEP 42:
    Loss: 0.000057
    LR: 1.92e-05
    Grad norm: 0.001251
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.000040, scaled=0.000010, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.000040, scaled=0.000010, accumulated=0.000020
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000001, scaled=0.000000, accumulated=0.000020
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.000041, scaled=0.000010, accumulated=0.000030
📊 ✅ OPTIMIZATION STEP 43:
    Loss: 0.000030
    LR: 1.89e-05
    Grad norm: 0.000484
    Duration: 0.30s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=0.000040, scaled=0.000010, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.000035, scaled=0.000009, accumulated=0.000019
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000367, scaled=0.000092, accumulated=0.000110
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.000414, scaled=0.000104, accumulated=0.000214
📊 ✅ OPTIMIZATION STEP 44:
    Loss: 0.000214
    LR: 1.85e-05
    Grad norm: 0.002465
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.000035, scaled=0.000009, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.000035, scaled=0.000009, accumulated=0.000017
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.000034, scaled=0.000009, accumulated=0.000026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.000036, scaled=0.000009, accumulated=0.000035
📊 ✅ OPTIMIZATION STEP 45:
    Loss: 0.000035
    LR: 1.82e-05
    Grad norm: 0.000573
    Duration: 0.36s
    Batches accumulated: 4
💾 Saving checkpoint at step 45
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-35
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000102, scaled=0.000025, accumulated=0.000025
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.000036, scaled=0.000009, accumulated=0.000034
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.000035, scaled=0.000009, accumulated=0.000043
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.000280, scaled=0.000070, accumulated=0.000113
📊 ✅ OPTIMIZATION STEP 46:
    Loss: 0.000113
    LR: 1.79e-05
    Grad norm: 0.001815
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.000669, scaled=0.000167, accumulated=0.000167
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.000101, scaled=0.000025, accumulated=0.000192
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.002096, scaled=0.000524, accumulated=0.000716
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.000031, scaled=0.000008, accumulated=0.000724
📊 ✅ OPTIMIZATION STEP 47:
    Loss: 0.000724
    LR: 1.75e-05
    Grad norm: 0.008964
    Duration: 0.27s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.000323, scaled=0.000081, accumulated=0.000081
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.000034, scaled=0.000008, accumulated=0.000089
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.000001, scaled=0.000000, accumulated=0.000089
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.000242, scaled=0.000060, accumulated=0.000150
📊 ✅ OPTIMIZATION STEP 48:
    Loss: 0.000150
    LR: 1.72e-05
    Grad norm: 0.002153
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000030, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.000093, scaled=0.000023, accumulated=0.000031
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.000031, scaled=0.000008, accumulated=0.000038
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.001968, scaled=0.000492, accumulated=0.000530
📊 ✅ OPTIMIZATION STEP 49:
    Loss: 0.000530
    LR: 1.69e-05
    Grad norm: 0.007776
    Duration: 0.24s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.000001, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.000029, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000028, scaled=0.000007, accumulated=0.000014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.000499, scaled=0.000125, accumulated=0.000139
📊 ✅ OPTIMIZATION STEP 50:
    Loss: 0.000139
    LR: 1.65e-05
    Grad norm: 0.002476
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 50
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-40
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.000091, scaled=0.000023, accumulated=0.000023
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000028, scaled=0.000007, accumulated=0.000030
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000199, scaled=0.000050, accumulated=0.000080
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.000028, scaled=0.000007, accumulated=0.000087
📊 ✅ OPTIMIZATION STEP 51:
    Loss: 0.000087
    LR: 1.62e-05
    Grad norm: 0.001151
    Duration: 0.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000026, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000494, scaled=0.000123, accumulated=0.000130
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.000504, scaled=0.000126, accumulated=0.000256
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000001, scaled=0.000000, accumulated=0.000256
📊 ✅ OPTIMIZATION STEP 52:
    Loss: 0.000256
    LR: 1.58e-05
    Grad norm: 0.004863
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.000026, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.000173, scaled=0.000043, accumulated=0.000050
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.001271, scaled=0.000318, accumulated=0.000368
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000081, scaled=0.000020, accumulated=0.000388
📊 ✅ OPTIMIZATION STEP 53:
    Loss: 0.000388
    LR: 1.55e-05
    Grad norm: 0.005663
    Duration: 0.23s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000023, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000027, scaled=0.000007, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.000026, scaled=0.000007, accumulated=0.000019
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.000025, scaled=0.000006, accumulated=0.000025
📊 ✅ OPTIMIZATION STEP 54:
    Loss: 0.000025
    LR: 1.52e-05
    Grad norm: 0.000429
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.000026, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.000001, scaled=0.000000, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000026, scaled=0.000006, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000026, scaled=0.000007, accumulated=0.000020
📊 ✅ OPTIMIZATION STEP 55:
    Loss: 0.000020
    LR: 1.48e-05
    Grad norm: 0.000267
    Duration: 0.27s
    Batches accumulated: 4
💾 Saving checkpoint at step 55
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-45
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.000026, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000026, scaled=0.000006, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000417, scaled=0.000104, accumulated=0.000117
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000001, scaled=0.000000, accumulated=0.000117
📊 ✅ OPTIMIZATION STEP 56:
    Loss: 0.000117
    LR: 1.45e-05
    Grad norm: 0.002181
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000255, scaled=0.000064, accumulated=0.000064
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.000001, scaled=0.000000, accumulated=0.000064
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000024, scaled=0.000006, accumulated=0.000070
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000072, scaled=0.000018, accumulated=0.000088
📊 ✅ OPTIMIZATION STEP 57:
    Loss: 0.000088
    LR: 1.42e-05
    Grad norm: 0.001013
    Duration: 0.52s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000024, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000023, scaled=0.000006, accumulated=0.000012
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000062, scaled=0.000015, accumulated=0.000027
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000024, scaled=0.000006, accumulated=0.000033
📊 ✅ OPTIMIZATION STEP 58:
    Loss: 0.000033
    LR: 1.38e-05
    Grad norm: 0.000462
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000917, scaled=0.000229, accumulated=0.000229
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000179, scaled=0.000045, accumulated=0.000274
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000914, scaled=0.000228, accumulated=0.000502
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.000023, scaled=0.000006, accumulated=0.000508
📊 ✅ OPTIMIZATION STEP 59:
    Loss: 0.000508
    LR: 1.35e-05
    Grad norm: 0.008745
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000024, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000001, scaled=0.000000, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000023, scaled=0.000006, accumulated=0.000012
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000023, scaled=0.000006, accumulated=0.000018
📊 ✅ OPTIMIZATION STEP 60:
    Loss: 0.000018
    LR: 1.31e-05
    Grad norm: 0.000242
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 60
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-50
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.000022, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.000023, scaled=0.000006, accumulated=0.000011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.000259, scaled=0.000065, accumulated=0.000076
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000825, scaled=0.000206, accumulated=0.000282
📊 ✅ OPTIMIZATION STEP 61:
    Loss: 0.000282
    LR: 1.28e-05
    Grad norm: 0.004149
    Duration: 0.34s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.000023, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.000022, scaled=0.000005, accumulated=0.000011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000021, scaled=0.000005, accumulated=0.000016
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000238, scaled=0.000059, accumulated=0.000076
📊 ✅ OPTIMIZATION STEP 62:
    Loss: 0.000076
    LR: 1.25e-05
    Grad norm: 0.000965
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000024, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000292, scaled=0.000073, accumulated=0.000079
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000023, scaled=0.000006, accumulated=0.000085
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000022, scaled=0.000006, accumulated=0.000090
📊 ✅ OPTIMIZATION STEP 63:
    Loss: 0.000090
    LR: 1.21e-05
    Grad norm: 0.001534
    Duration: 0.65s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000022, scaled=0.000006, accumulated=0.000006
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000059, scaled=0.000015, accumulated=0.000020
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.000023, scaled=0.000006, accumulated=0.000026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000022, scaled=0.000005, accumulated=0.000032
📊 ✅ OPTIMIZATION STEP 64:
    Loss: 0.000032
    LR: 1.18e-05
    Grad norm: 0.000458
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000022, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000126, scaled=0.000031, accumulated=0.000037
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000022, scaled=0.000005, accumulated=0.000042
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000270, scaled=0.000067, accumulated=0.000110
📊 ✅ OPTIMIZATION STEP 65:
    Loss: 0.000110
    LR: 1.15e-05
    Grad norm: 0.001661
    Duration: 0.27s
    Batches accumulated: 4
💾 Saving checkpoint at step 65
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-55
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000143, scaled=0.000036, accumulated=0.000036
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000020, scaled=0.000005, accumulated=0.000041
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000019, scaled=0.000005, accumulated=0.000046
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000021, scaled=0.000005, accumulated=0.000051
📊 ✅ OPTIMIZATION STEP 66:
    Loss: 0.000051
    LR: 1.11e-05
    Grad norm: 0.000943
    Duration: 0.03s
    Batches accumulated: 4

✅ Epoch 2 completed:
    Average loss: 0.000072
    Duration: 189.7s
    Optimization steps this epoch: 33
    Total optimization steps so far: 66

🔄 === Epoch 3/3 ===
📊 Epoch 3: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000021
🔄 Batch 1/132: loss=0.000021, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000020
🔄 Batch 2/132: loss=0.000020, scaled=0.000005, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 1 to 94506
  Loss: 0.000049
🔄 Batch 3/132: loss=0.000049, scaled=0.000012, accumulated=0.000023
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 4/132: loss=0.000020, scaled=0.000005, accumulated=0.000028
📊 ✅ OPTIMIZATION STEP 67:
    Loss: 0.000028
    LR: 1.08e-05
    Grad norm: 0.000494
    Duration: 0.21s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AIO...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 5/132: loss=0.000020, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 6/132: loss=0.000021, scaled=0.000005, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 7/132: loss=0.000020, scaled=0.000005, accumulated=0.000015
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 8/132: loss=0.000023, scaled=0.000006, accumulated=0.000021
📊 ✅ OPTIMIZATION STEP 68:
    Loss: 0.000021
    LR: 1.04e-05
    Grad norm: 0.000298
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 9/132: loss=0.000020, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 10/132: loss=0.000166, scaled=0.000041, accumulated=0.000046
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Rom...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 11/132: loss=0.000060, scaled=0.000015, accumulated=0.000061
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 12/132: loss=0.000652, scaled=0.000163, accumulated=0.000224
📊 ✅ OPTIMIZATION STEP 69:
    Loss: 0.000224
    LR: 1.01e-05
    Grad norm: 0.003677
    Duration: 0.28s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 13/132: loss=0.000057, scaled=0.000014, accumulated=0.000014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 14/132: loss=0.000001, scaled=0.000000, accumulated=0.000014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 15/132: loss=0.000214, scaled=0.000053, accumulated=0.000068
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 16/132: loss=0.000020, scaled=0.000005, accumulated=0.000073
📊 ✅ OPTIMIZATION STEP 70:
    Loss: 0.000073
    LR: 9.78e-06
    Grad norm: 0.000906
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 70
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-60
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 17/132: loss=0.000000, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 18/132: loss=0.000001, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 19/132: loss=0.000021, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 20/132: loss=0.000020, scaled=0.000005, accumulated=0.000010
📊 ✅ OPTIMIZATION STEP 71:
    Loss: 0.000010
    LR: 9.44e-06
    Grad norm: 0.000154
    Duration: 0.59s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 21/132: loss=0.000587, scaled=0.000147, accumulated=0.000147
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Emp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 22/132: loss=0.000020, scaled=0.000005, accumulated=0.000152
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Branch",
  "fraud_type": "A...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 23/132: loss=0.000020, scaled=0.000005, accumulated=0.000157
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 24/132: loss=0.000019, scaled=0.000005, accumulated=0.000162
📊 ✅ OPTIMIZATION STEP 72:
    Loss: 0.000162
    LR: 9.10e-06
    Grad norm: 0.002954
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 25/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 26/132: loss=0.000019, scaled=0.000005, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 27/132: loss=0.000017, scaled=0.000004, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 28/132: loss=0.000018, scaled=0.000005, accumulated=0.000018
📊 ✅ OPTIMIZATION STEP 73:
    Loss: 0.000018
    LR: 8.76e-06
    Grad norm: 0.000310
    Duration: 0.54s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Imp...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 29/132: loss=0.000020, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 30/132: loss=0.000257, scaled=0.000064, accumulated=0.000069
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 31/132: loss=0.000018, scaled=0.000005, accumulated=0.000074
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 32/132: loss=0.000219, scaled=0.000055, accumulated=0.000129
📊 ✅ OPTIMIZATION STEP 74:
    Loss: 0.000129
    LR: 8.43e-06
    Grad norm: 0.001686
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 33/132: loss=0.000020, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 34/132: loss=0.000110, scaled=0.000027, accumulated=0.000032
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 35/132: loss=0.000209, scaled=0.000052, accumulated=0.000085
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 36/132: loss=0.000018, scaled=0.000004, accumulated=0.000089
📊 ✅ OPTIMIZATION STEP 75:
    Loss: 0.000089
    LR: 8.09e-06
    Grad norm: 0.001537
    Duration: 0.32s
    Batches accumulated: 4
💾 Saving checkpoint at step 75
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-65
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 37/132: loss=0.000052, scaled=0.000013, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 38/132: loss=0.000017, scaled=0.000004, accumulated=0.000017
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 39/132: loss=0.000049, scaled=0.000012, accumulated=0.000029
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 40/132: loss=0.000219, scaled=0.000055, accumulated=0.000084
📊 ✅ OPTIMIZATION STEP 76:
    Loss: 0.000084
    LR: 7.75e-06
    Grad norm: 0.001043
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP-...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 41/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 42/132: loss=0.000001, scaled=0.000000, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 43/132: loss=0.000021, scaled=0.000005, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 44/132: loss=0.000019, scaled=0.000005, accumulated=0.000015
📊 ✅ OPTIMIZATION STEP 77:
    Loss: 0.000015
    LR: 7.42e-06
    Grad norm: 0.000219
    Duration: 0.30s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 45/132: loss=0.000210, scaled=0.000052, accumulated=0.000052
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 46/132: loss=0.000020, scaled=0.000005, accumulated=0.000057
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 47/132: loss=0.000118, scaled=0.000029, accumulated=0.000087
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 48/132: loss=0.000225, scaled=0.000056, accumulated=0.000143
📊 ✅ OPTIMIZATION STEP 78:
    Loss: 0.000143
    LR: 7.08e-06
    Grad norm: 0.001897
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 49/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 50/132: loss=0.000017, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 51/132: loss=0.000018, scaled=0.000005, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 52/132: loss=0.000016, scaled=0.000004, accumulated=0.000017
📊 ✅ OPTIMIZATION STEP 79:
    Loss: 0.000017
    LR: 6.74e-06
    Grad norm: 0.000306
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 53/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 54/132: loss=0.000210, scaled=0.000053, accumulated=0.000057
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 55/132: loss=0.000000, scaled=0.000000, accumulated=0.000057
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 56/132: loss=0.000046, scaled=0.000012, accumulated=0.000069
📊 ✅ OPTIMIZATION STEP 80:
    Loss: 0.000069
    LR: 6.40e-06
    Grad norm: 0.000866
    Duration: 0.04s
    Batches accumulated: 4
💾 Saving checkpoint at step 80
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-70
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 57/132: loss=0.000019, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 58/132: loss=0.000001, scaled=0.000000, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 59/132: loss=0.000053, scaled=0.000013, accumulated=0.000018
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 60/132: loss=0.000121, scaled=0.000030, accumulated=0.000048
📊 ✅ OPTIMIZATION STEP 81:
    Loss: 0.000048
    LR: 6.07e-06
    Grad norm: 0.002586
    Duration: 0.48s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 61/132: loss=0.000018, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 62/132: loss=0.000018, scaled=0.000005, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 63/132: loss=0.000001, scaled=0.000000, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 64/132: loss=0.000509, scaled=0.000127, accumulated=0.000136
📊 ✅ OPTIMIZATION STEP 82:
    Loss: 0.000136
    LR: 5.73e-06
    Grad norm: 0.002597
    Duration: 0.04s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 65/132: loss=0.000042, scaled=0.000011, accumulated=0.000011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 66/132: loss=0.000046, scaled=0.000012, accumulated=0.000022
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 67/132: loss=0.000020, scaled=0.000005, accumulated=0.000027
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 68/132: loss=0.000036, scaled=0.000009, accumulated=0.000036
📊 ✅ OPTIMIZATION STEP 83:
    Loss: 0.000036
    LR: 5.39e-06
    Grad norm: 0.000741
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 69/132: loss=0.000020, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 70/132: loss=0.000001, scaled=0.000000, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 71/132: loss=0.000487, scaled=0.000122, accumulated=0.000127
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 72/132: loss=0.000460, scaled=0.000115, accumulated=0.000242
📊 ✅ OPTIMIZATION STEP 84:
    Loss: 0.000242
    LR: 5.06e-06
    Grad norm: 0.004851
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 73/132: loss=0.000001, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 74/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 75/132: loss=0.000017, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Inv...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 76/132: loss=0.000106, scaled=0.000027, accumulated=0.000035
📊 ✅ OPTIMIZATION STEP 85:
    Loss: 0.000035
    LR: 4.72e-06
    Grad norm: 0.002121
    Duration: 0.60s
    Batches accumulated: 4
💾 Saving checkpoint at step 85
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-75
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 77/132: loss=0.000222, scaled=0.000055, accumulated=0.000055
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 78/132: loss=0.000018, scaled=0.000005, accumulated=0.000060
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 79/132: loss=0.000001, scaled=0.000000, accumulated=0.000060
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 80/132: loss=0.000042, scaled=0.000011, accumulated=0.000071
📊 ✅ OPTIMIZATION STEP 86:
    Loss: 0.000071
    LR: 4.38e-06
    Grad norm: 0.001252
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 81/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 82/132: loss=0.000018, scaled=0.000005, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 83/132: loss=0.000017, scaled=0.000004, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 84/132: loss=0.000047, scaled=0.000012, accumulated=0.000025
📊 ✅ OPTIMIZATION STEP 87:
    Loss: 0.000025
    LR: 4.04e-06
    Grad norm: 0.000355
    Duration: 0.20s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 85/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 86/132: loss=0.000191, scaled=0.000048, accumulated=0.000052
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 87/132: loss=0.000465, scaled=0.000116, accumulated=0.000168
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 88/132: loss=0.000115, scaled=0.000029, accumulated=0.000197
📊 ✅ OPTIMIZATION STEP 88:
    Loss: 0.000197
    LR: 3.71e-06
    Grad norm: 0.002890
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 89/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 90/132: loss=0.000018, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 91/132: loss=0.000018, scaled=0.000004, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 92/132: loss=0.000019, scaled=0.000005, accumulated=0.000018
📊 ✅ OPTIMIZATION STEP 89:
    Loss: 0.000018
    LR: 3.37e-06
    Grad norm: 0.000256
    Duration: 0.22s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 93/132: loss=0.000193, scaled=0.000048, accumulated=0.000048
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 94/132: loss=0.000212, scaled=0.000053, accumulated=0.000101
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 95/132: loss=0.000117, scaled=0.000029, accumulated=0.000131
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 96/132: loss=0.000019, scaled=0.000005, accumulated=0.000135
📊 ✅ OPTIMIZATION STEP 90:
    Loss: 0.000135
    LR: 3.03e-06
    Grad norm: 0.002389
    Duration: 0.03s
    Batches accumulated: 4
💾 Saving checkpoint at step 90
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-80
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 97/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: 'TBC...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 98/132: loss=0.000017, scaled=0.000004, accumulated=0.000008
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 99/132: loss=0.000019, scaled=0.000005, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 100/132: loss=0.000043, scaled=0.000011, accumulated=0.000024
📊 ✅ OPTIMIZATION STEP 91:
    Loss: 0.000024
    LR: 2.70e-06
    Grad norm: 0.000368
    Duration: 0.20s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 101/132: loss=0.000001, scaled=0.000000, accumulated=0.000000
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 102/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 103/132: loss=0.000016, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 104/132: loss=0.000015, scaled=0.000004, accumulated=0.000013
📊 ✅ OPTIMIZATION STEP 92:
    Loss: 0.000013
    LR: 2.36e-06
    Grad norm: 0.000186
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '```json
{
  "source": "Victim ODFT",
  "fraud_type...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 105/132: loss=0.000199, scaled=0.000050, accumulated=0.000050
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 106/132: loss=0.000017, scaled=0.000004, accumulated=0.000054
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 107/132: loss=0.000218, scaled=0.000054, accumulated=0.000108
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 108/132: loss=0.000018, scaled=0.000005, accumulated=0.000113
📊 ✅ OPTIMIZATION STEP 93:
    Loss: 0.000113
    LR: 2.02e-06
    Grad norm: 0.001487
    Duration: 0.20s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 109/132: loss=0.000018, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 110/132: loss=0.000017, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 111/132: loss=0.000018, scaled=0.000004, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 112/132: loss=0.000016, scaled=0.000004, accumulated=0.000017
📊 ✅ OPTIMIZATION STEP 94:
    Loss: 0.000017
    LR: 1.69e-06
    Grad norm: 0.000249
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 113/132: loss=0.000016, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 114/132: loss=0.000489, scaled=0.000122, accumulated=0.000126
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 115/132: loss=0.000045, scaled=0.000011, accumulated=0.000138
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 116/132: loss=0.000000, scaled=0.000000, accumulated=0.000138
📊 ✅ OPTIMIZATION STEP 95:
    Loss: 0.000138
    LR: 1.35e-06
    Grad norm: 0.002607
    Duration: 0.40s
    Batches accumulated: 4
💾 Saving checkpoint at step 95
🗑️ Removing old checkpoint: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/checkpoint-85
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 117/132: loss=0.000018, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 118/132: loss=0.000018, scaled=0.000004, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 119/132: loss=0.000043, scaled=0.000011, accumulated=0.000020
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 120/132: loss=0.000049, scaled=0.000012, accumulated=0.000032
📊 ✅ OPTIMIZATION STEP 96:
    Loss: 0.000032
    LR: 1.01e-06
    Grad norm: 0.000474
    Duration: 0.03s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Soc...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 121/132: loss=0.000098, scaled=0.000024, accumulated=0.000024
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ODFO",
  "fraud_type": "AP ...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 122/132: loss=0.000017, scaled=0.000004, accumulated=0.000029
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 123/132: loss=0.000000, scaled=0.000000, accumulated=0.000029
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 124/132: loss=0.000017, scaled=0.000004, accumulated=0.000033
📊 ✅ OPTIMIZATION STEP 97:
    Loss: 0.000033
    LR: 6.74e-07
    Grad norm: 0.000736
    Duration: 0.82s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 125/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 126/132: loss=0.000434, scaled=0.000108, accumulated=0.000113
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '```json
{
  "source": "Search Warrant",
  "fraud_t...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 127/132: loss=0.000459, scaled=0.000115, accumulated=0.000227
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 128/132: loss=0.000016, scaled=0.000004, accumulated=0.000231
📊 ✅ OPTIMIZATION STEP 98:
    Loss: 0.000231
    LR: 3.37e-07
    Grad norm: 0.004672
    Duration: 0.04s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "HSBC Referral",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 129/132: loss=0.000018, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '```json
{
  "source": "Police Letter",
  "fraud_ty...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 130/132: loss=0.000039, scaled=0.000010, accumulated=0.000014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '```json
{
  "source": "Internal Referral",
  "frau...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 131/132: loss=0.000015, scaled=0.000004, accumulated=0.000018
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '```json
{
  "source": "ADCC",
  "fraud_type": "Tel...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 94506
🔄 Batch 132/132: loss=0.000018, scaled=0.000005, accumulated=0.000022
📊 ✅ OPTIMIZATION STEP 99:
    Loss: 0.000022
    LR: 0.00e+00
    Grad norm: 0.000327
    Duration: 0.52s
    Batches accumulated: 4

✅ Epoch 3 completed:
    Average loss: 0.000020
    Duration: 178.8s
    Optimization steps this epoch: 33
    Total optimization steps so far: 99

🎉 Training completed! Total optimization steps: 99
💾 Saving final model...
✅ Model saved to ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA
🎉 Training and saving completed successfully!

🔍 Final GPU memory state:
GPU Memory Usage:
  GPU 0: 32.29GB allocated, 32.67GB reserved
  GPU 1: 32.15GB allocated, 32.48GB reserved

================================================================================
📊 COMPREHENSIVE TRAINING METRICS REPORT
================================================================================

🎯 TRAINING OVERVIEW
----------------------------------------
📅 Total Training Time: 0:09:26
🔢 Total Training Steps: 99
⚡ Average Step Duration: 0.200 seconds
🚀 Steps per Second: 4.99
📈 Initial Loss: 0.0224
🏁 Final Loss: 0.0000
🎯 Best Loss: 0.0000
📉 Loss Improvement: 0.0224
📊 Loss Improvement: 99.90%

⏱️  STEP TIMING BREAKDOWN
----------------------------------------
🔧 total_training: 9m 26.0s
🔧 data_loading: 0m 0.5s
🔧 model_loading: 0m 13.5s
🔧 lora_setup: 0m 2.3s
🔧 training_setup: 0m 0.0s
🔧 training_loop: 8m 59.6s
🔧 model_saving: 0m 8.4s

💻 RESOURCE UTILIZATION
----------------------------------------
🖥️  Peak CPU Usage: 0.0%
📊 Average CPU Usage: 0.7%

🎮 GPU Memory Usage:
  GPU 0: 32.29 GB (peak)
  GPU 1: 32.15 GB (peak)

💾 Disk I/O:
  📖 Read: 0.01 GB
  📝 Write: 0.05 GB
  📊 Total: 0.06 GB
================================================================================
📊 Detailed metrics saved to: ./output_models/job_20250527_2058_qwen_Qwen2.5-32B-Instruct_LoRA/training_metrics

==================================================
🎉 MODEL PARALLEL TRAINING COMPLETED SUCCESSFULLY!
==================================================

==================================================
STARTING CLEANUP PROCESS
==================================================
Closing TensorBoard writer...
Clearing model...
Cleanup completed!
==================================================
🧹 All cleanup completed. Exiting.

Program exiting normally...

==================================================
STARTING CLEANUP PROCESS
==================================================
Cleanup completed!
==================================================
Found 0 child processes to terminate
