
=============
== PyTorch ==
=============

NVIDIA Release 24.08 (build 107063150)
PyTorch Version 2.5.0a0+872d972
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

ERROR: This container was built for NVIDIA Driver Release 560.35 or later, but
       version 535.161.08 was detected and compatibility mode is UNAVAILABLE.

       [[]]

Looking in links: /cm/shared/python_modules/
Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.51.3)
Requirement already satisfied: accelerate in /usr/local/lib/python3.10/dist-packages (1.7.0)
Requirement already satisfied: deepspeed in /usr/local/lib/python3.10/dist-packages (0.16.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.15.4)
Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.31.4)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.24.4)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0.2)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2024.7.24)
Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.32.3)
Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.21.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.5.3)
Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.66.5)
Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (6.0.0)
Requirement already satisfied: torch>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.5.0a0+872d972e41.nv24.8)
Requirement already satisfied: hjson in /usr/local/lib/python3.10/dist-packages (from deepspeed) (3.1.0)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.0.8)
Requirement already satisfied: ninja in /usr/local/lib/python3.10/dist-packages (from deepspeed) (1.11.1.1)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from deepspeed) (9.0.0)
Requirement already satisfied: pydantic>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from deepspeed) (2.8.2)
Requirement already satisfied: nvidia-ml-py in /usr/local/lib/python3.10/dist-packages (from deepspeed) (12.560.30)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (2024.6.1)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.30.0->transformers) (4.12.2)
Requirement already satisfied: annotated-types>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (0.7.0)
Requirement already satisfied: pydantic-core==2.20.1 in /usr/local/lib/python3.10/dist-packages (from pydantic>=2.0.0->deepspeed) (2.20.1)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (3.1.4)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=2.0.0->accelerate) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=2.0.0->accelerate) (1.3.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2024.7.4)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=2.0.0->accelerate) (2.1.5)
[2025-05-28 17:00:54,762] [INFO] [real_accelerator.py:219:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/1787/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Configuration loaded from config-llama-8b-instruct.json
✓ Configuration validation passed
============================================================
LOADED CONFIGURATION
============================================================
📁 Model Configuration:
  Model path: /cm/shared/llm_models/meta-llama/Llama3.1-8B-Instruct
  Model family: llama

📊 Data Configuration:
  Training data: dataset/train_set.csv
  Evaluation data: dataset/test_set.csv

🔧 LoRA Configuration:
  Use LoRA: False

🚀 Training Configuration:
  Batch size: 1
  Learning rate: 3e-05
  Number of epochs: 3
  Max sequence length: 512
  Gradient accumulation steps: 4
  Warmup steps: 10

💾 Output Configuration:
  Output directory: Auto-generated
============================================================

🖥️  Available GPUs: 2
📁 Output directory: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT

🔍 Initial GPU memory state:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
🔤 Loading tokenizer...
✓ Tokenizer padding side set to: left
📚 Creating datasets...
📊 Loaded 132 examples from dataset/train_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number', 'Llama 8B Instruct Base', 'Llama 70B Instruct Base', 'Qwen 32B Instruct Base', 'Qwen 72B Instruct Base']
📊 Loaded 34 examples from dataset/test_set.csv
📋 Columns: ['Type', 'Case Number', 'Instruction', 'Input', 'Output', 'Evaluation Criteria', 'Source Markdown File', 'IR Markdown File', 'IR Raw File', 'Suspect Number', 'Intelligence Number', 'Llama 8B Instruct Base', 'Llama 70B Instruct Base', 'Qwen 32B Instruct Base', 'Qwen 72B Instruct Base']

🔍 After data loading:
GPU Memory Usage:
  GPU 0: 0.00GB allocated, 0.00GB reserved
  GPU 1: 0.00GB allocated, 0.00GB reserved
Creating device map for 2 GPUs...
Model has 32 layers
Distributing 32 layers across 2 GPUs
Base layers per GPU: 16
GPU 0: layers 0 to 15 (16 layers)
GPU 1: layers 16 to 31 (16 layers)
🤖 Loading model with model parallelism...
✓ Model loaded with model parallelism
GPU Memory Usage:
  GPU 0: 7.48GB allocated, 7.54GB reserved
  GPU 1: 7.48GB allocated, 7.54GB reserved
🔧 Using full fine-tuning (no LoRA)

🔍 After model setup:
GPU Memory Usage:
  GPU 0: 7.48GB allocated, 7.54GB reserved
  GPU 1: 7.48GB allocated, 7.54GB reserved
🎯 All model parameters are trainable (full fine-tuning)
📊 Trainable parameters: 8,030,261,248 (100.00%)
🔧 Transformers version: 4.51.3
🔤 Tokenizer Debug Info:
  Vocab size: 128000
  Model max length: 131072
  Available special tokens:
    bos_token: '<|begin_of_text|>' (ID: 128000) 🚨 INVALID
    eos_token: '<|eot_id|>' (ID: 128009) 🚨 INVALID
    pad_token: '<|eot_id|>' (ID: 128009) 🚨 INVALID
    unk_token: None
  Testing conversation tokens:
    '<|begin_of_text|>': ID 128000 ❌ (broken/invalid)
    '<|start_header_id|>': ID 128006 ❌ (broken/invalid)
    '<|end_header_id|>': ID 128007 ❌ (broken/invalid)
    '<|eot_id|>': ID 128009 ❌ (broken/invalid)
    '<|im_start|>': ❌ NOT FOUND
    '<|im_end|>': ❌ NOT FOUND
    '<s>': ❌ NOT FOUND
    '</s>': ❌ NOT FOUND
    '[INST]': ❌ NOT FOUND
    '[/INST]': ❌ NOT FOUND
    '<|user|>': ❌ NOT FOUND
    '<|assistant|>': ❌ NOT FOUND
    '<|system|>': ❌ NOT FOUND
    'Human:': ❌ NOT FOUND
    'Assistant:': ❌ NOT FOUND
    'User:': ❌ NOT FOUND
    'AI:': ❌ NOT FOUND
  Selected prompt format: plain_text
📊 Number of trainable parameter tensors: 291
📈 Total training steps: 99

============================================================
🚀 STARTING TRAINING
============================================================
  📊 Num examples = 132
  🔄 Num Epochs = 3
  📦 Batch size per device = 1
  📦 Total train batch size = 4
  🔄 Gradient Accumulation steps = 4
  📈 Total optimization steps = 99
============================================================

🔄 === Epoch 1/3 ===
📊 Epoch 1: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 79068
  Loss: 1.311867
🔄 Batch 1/132: loss=1.311867, scaled=0.327967, accumulated=0.327967
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 79068
  Loss: 1.758615
🔄 Batch 2/132: loss=1.758615, scaled=0.439654, accumulated=0.767620
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 79068
  Loss: 2.276689
🔄 Batch 3/132: loss=2.276689, scaled=0.569172, accumulated=1.336793
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 4/132: loss=0.152234, scaled=0.038058, accumulated=1.374851
📊 ✅ OPTIMIZATION STEP 1:
    Loss: 1.374851
    LR: 3.00e-06
    Grad norm: 78.000000
    Duration: 1.47s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "D...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 5/132: loss=0.152234, scaled=0.038058, accumulated=0.038058
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Onli...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 122357
🔄 Batch 6/132: loss=1.015164, scaled=0.253791, accumulated=0.291849
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 7/132: loss=1.046030, scaled=0.261508, accumulated=0.553357
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 8/132: loss=1.947483, scaled=0.486871, accumulated=1.040228
📊 ✅ OPTIMIZATION STEP 2:
    Loss: 1.040228
    LR: 6.00e-06
    Grad norm: 46.500000
    Duration: 0.19s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 9/132: loss=0.213026, scaled=0.053257, accumulated=0.053257
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 10/132: loss=3.605169, scaled=0.901292, accumulated=0.954549
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ph...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 11/132: loss=0.230465, scaled=0.057616, accumulated=1.012165
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 12/132: loss=1.592085, scaled=0.398021, accumulated=1.410186
📊 ✅ OPTIMIZATION STEP 3:
    Loss: 1.410186
    LR: 9.00e-06
    Grad norm: 64.000000
    Duration: 0.39s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Smis...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 13/132: loss=2.293231, scaled=0.573308, accumulated=0.573308
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 14/132: loss=1.220010, scaled=0.305003, accumulated=0.878310
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 15/132: loss=0.015574, scaled=0.003894, accumulated=0.882204
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 16/132: loss=1.925173, scaled=0.481293, accumulated=1.363497
📊 ✅ OPTIMIZATION STEP 4:
    Loss: 1.363497
    LR: 1.20e-05
    Grad norm: 63.750000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 17/132: loss=0.004682, scaled=0.001171, accumulated=0.001171
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 18/132: loss=0.743079, scaled=0.185770, accumulated=0.186940
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 19/132: loss=2.185552, scaled=0.546388, accumulated=0.733328
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 20/132: loss=0.987502, scaled=0.246875, accumulated=0.980204
📊 ✅ OPTIMIZATION STEP 5:
    Loss: 0.980204
    LR: 1.50e-05
    Grad norm: 61.750000
    Duration: 0.58s
    Batches accumulated: 4
💾 Saving checkpoint at step 5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 21/132: loss=1.691557, scaled=0.422889, accumulated=0.422889
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 22/132: loss=3.110085, scaled=0.777521, accumulated=1.200411
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 23/132: loss=1.423850, scaled=0.355963, accumulated=1.556373
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 24/132: loss=7.230234, scaled=1.807558, accumulated=3.363932
📊 ✅ OPTIMIZATION STEP 6:
    Loss: 3.363932
    LR: 1.80e-05
    Grad norm: 99.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 25/132: loss=0.421869, scaled=0.105467, accumulated=0.105467
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 26/132: loss=1.114451, scaled=0.278613, accumulated=0.384080
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 27/132: loss=1.397690, scaled=0.349423, accumulated=0.733502
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 28/132: loss=0.085847, scaled=0.021462, accumulated=0.754964
📊 ✅ OPTIMIZATION STEP 7:
    Loss: 0.754964
    LR: 2.10e-05
    Grad norm: 61.750000
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 29/132: loss=0.368497, scaled=0.092124, accumulated=0.092124
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 30/132: loss=0.368497, scaled=0.092124, accumulated=0.184248
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 96545
🔄 Batch 31/132: loss=1.828597, scaled=0.457149, accumulated=0.641398
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 32/132: loss=1.009028, scaled=0.252257, accumulated=0.893655
📊 ✅ OPTIMIZATION STEP 8:
    Loss: 0.893655
    LR: 2.40e-05
    Grad norm: 115.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 33/132: loss=4.978730, scaled=1.244683, accumulated=1.244683
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Inve...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 34/132: loss=0.739193, scaled=0.184798, accumulated=1.429481
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 35/132: loss=0.094147, scaled=0.023537, accumulated=1.453018
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 36/132: loss=1.484209, scaled=0.371052, accumulated=1.824070
📊 ✅ OPTIMIZATION STEP 9:
    Loss: 1.824070
    LR: 2.70e-05
    Grad norm: 61.750000
    Duration: 0.74s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 37/132: loss=1.307269, scaled=0.326817, accumulated=0.326817
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 38/132: loss=0.138524, scaled=0.034631, accumulated=0.361448
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 39/132: loss=0.009605, scaled=0.002401, accumulated=0.363849
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 40/132: loss=1.415936, scaled=0.353984, accumulated=0.717833
📊 ✅ OPTIMIZATION STEP 10:
    Loss: 0.717833
    LR: 3.00e-05
    Grad norm: 73.000000
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 41/132: loss=0.088104, scaled=0.022026, accumulated=0.022026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 42/132: loss=0.003498, scaled=0.000875, accumulated=0.022900
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Un...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 43/132: loss=3.501368, scaled=0.875342, accumulated=0.898243
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AI...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 44/132: loss=3.822932, scaled=0.955733, accumulated=1.853976
📊 ✅ OPTIMIZATION STEP 11:
    Loss: 1.853976
    LR: 2.97e-05
    Grad norm: 74.000000
    Duration: 0.55s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 45/132: loss=1.212347, scaled=0.303087, accumulated=0.303087
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 46/132: loss=0.470417, scaled=0.117604, accumulated=0.420691
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 47/132: loss=0.002855, scaled=0.000714, accumulated=0.421405
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 48/132: loss=0.001846, scaled=0.000462, accumulated=0.421866
📊 ✅ OPTIMIZATION STEP 12:
    Loss: 0.421866
    LR: 2.93e-05
    Grad norm: 31.250000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 49/132: loss=0.055965, scaled=0.013991, accumulated=0.013991
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 50/132: loss=0.635491, scaled=0.158873, accumulated=0.172864
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 51/132: loss=0.016938, scaled=0.004235, accumulated=0.177099
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 52/132: loss=0.001566, scaled=0.000391, accumulated=0.177490
📊 ✅ OPTIMIZATION STEP 13:
    Loss: 0.177490
    LR: 2.90e-05
    Grad norm: 15.125000
    Duration: 0.43s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 53/132: loss=7.837709, scaled=1.959427, accumulated=1.959427
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 54/132: loss=2.991755, scaled=0.747939, accumulated=2.707366
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 55/132: loss=4.291556, scaled=1.072889, accumulated=3.780255
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 56/132: loss=5.764071, scaled=1.441018, accumulated=5.221273
📊 ✅ OPTIMIZATION STEP 14:
    Loss: 5.221273
    LR: 2.87e-05
    Grad norm: 980.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 57/132: loss=2.652786, scaled=0.663197, accumulated=0.663197
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 58/132: loss=0.000290, scaled=0.000072, accumulated=0.663269
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 59/132: loss=0.006942, scaled=0.001736, accumulated=0.665005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 60/132: loss=9.162734, scaled=2.290684, accumulated=2.955688
📊 ✅ OPTIMIZATION STEP 15:
    Loss: 2.955688
    LR: 2.83e-05
    Grad norm: 132.000000
    Duration: 0.41s
    Batches accumulated: 4
💾 Saving checkpoint at step 15
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-5
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 61/132: loss=0.534820, scaled=0.133705, accumulated=0.133705
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "UA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 62/132: loss=0.001839, scaled=0.000460, accumulated=0.134165
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 63/132: loss=0.004354, scaled=0.001088, accumulated=0.135253
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 64/132: loss=1.320779, scaled=0.330195, accumulated=0.465448
📊 ✅ OPTIMIZATION STEP 16:
    Loss: 0.465448
    LR: 2.80e-05
    Grad norm: 35.250000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 65/132: loss=6.496987, scaled=1.624247, accumulated=1.624247
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 66/132: loss=5.823644, scaled=1.455911, accumulated=3.080158
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 67/132: loss=5.823644, scaled=1.455911, accumulated=4.536069
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 68/132: loss=5.823644, scaled=1.455911, accumulated=5.991980
📊 ✅ OPTIMIZATION STEP 17:
    Loss: 5.991980
    LR: 2.76e-05
    Grad norm: 392.000000
    Duration: 0.45s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 69/132: loss=0.005489, scaled=0.001372, accumulated=0.001372
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 70/132: loss=2.247234, scaled=0.561808, accumulated=0.563181
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 71/132: loss=0.020292, scaled=0.005073, accumulated=0.568254
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 72/132: loss=1.773723, scaled=0.443431, accumulated=1.011685
📊 ✅ OPTIMIZATION STEP 18:
    Loss: 1.011685
    LR: 2.73e-05
    Grad norm: 68.500000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 73/132: loss=0.027859, scaled=0.006965, accumulated=0.006965
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Co...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 74/132: loss=2.588076, scaled=0.647019, accumulated=0.653984
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 75/132: loss=4.011344, scaled=1.002836, accumulated=1.656820
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Bl...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 76/132: loss=2.863778, scaled=0.715945, accumulated=2.372764
📊 ✅ OPTIMIZATION STEP 19:
    Loss: 2.372764
    LR: 2.70e-05
    Grad norm: 79.000000
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 77/132: loss=0.277583, scaled=0.069396, accumulated=0.069396
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 78/132: loss=1.167691, scaled=0.291923, accumulated=0.361319
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 79/132: loss=1.618771, scaled=0.404693, accumulated=0.766011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 80/132: loss=2.870006, scaled=0.717502, accumulated=1.483513
📊 ✅ OPTIMIZATION STEP 20:
    Loss: 1.483513
    LR: 2.66e-05
    Grad norm: 128.000000
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 20
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-10
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 81/132: loss=0.047783, scaled=0.011946, accumulated=0.011946
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 82/132: loss=0.047783, scaled=0.011946, accumulated=0.023892
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 83/132: loss=0.597609, scaled=0.149402, accumulated=0.173294
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 84/132: loss=0.835881, scaled=0.208970, accumulated=0.382264
📊 ✅ OPTIMIZATION STEP 21:
    Loss: 0.382264
    LR: 2.63e-05
    Grad norm: 38.500000
    Duration: 0.45s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 85/132: loss=0.048097, scaled=0.012024, accumulated=0.012024
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 86/132: loss=0.100731, scaled=0.025183, accumulated=0.037207
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 87/132: loss=1.086457, scaled=0.271614, accumulated=0.308821
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 88/132: loss=0.003238, scaled=0.000810, accumulated=0.309631
📊 ✅ OPTIMIZATION STEP 22:
    Loss: 0.309631
    LR: 2.60e-05
    Grad norm: 14.812500
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 89/132: loss=2.308414, scaled=0.577103, accumulated=0.577103
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 90/132: loss=0.001299, scaled=0.000325, accumulated=0.577428
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 91/132: loss=0.001299, scaled=0.000325, accumulated=0.577753
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 92/132: loss=1.285653, scaled=0.321413, accumulated=0.899166
📊 ✅ OPTIMIZATION STEP 23:
    Loss: 0.899166
    LR: 2.56e-05
    Grad norm: 48.250000
    Duration: 0.49s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 93/132: loss=0.989114, scaled=0.247279, accumulated=0.247279
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 94/132: loss=3.684941, scaled=0.921235, accumulated=1.168514
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 79068
🔄 Batch 95/132: loss=3.199851, scaled=0.799963, accumulated=1.968476
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 96/132: loss=0.100125, scaled=0.025031, accumulated=1.993508
📊 ✅ OPTIMIZATION STEP 24:
    Loss: 1.993508
    LR: 2.53e-05
    Grad norm: 145.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 97/132: loss=0.388819, scaled=0.097205, accumulated=0.097205
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 98/132: loss=5.033461, scaled=1.258365, accumulated=1.355570
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 99/132: loss=0.176768, scaled=0.044192, accumulated=1.399762
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 100/132: loss=0.066759, scaled=0.016690, accumulated=1.416452
📊 ✅ OPTIMIZATION STEP 25:
    Loss: 1.416452
    LR: 2.49e-05
    Grad norm: 108.000000
    Duration: 0.48s
    Batches accumulated: 4
💾 Saving checkpoint at step 25
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-15
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 101/132: loss=0.152608, scaled=0.038152, accumulated=0.038152
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 102/132: loss=1.954750, scaled=0.488688, accumulated=0.526840
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 103/132: loss=2.429884, scaled=0.607471, accumulated=1.134311
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 104/132: loss=0.623786, scaled=0.155947, accumulated=1.290257
📊 ✅ OPTIMIZATION STEP 26:
    Loss: 1.290257
    LR: 2.46e-05
    Grad norm: 62.750000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 105/132: loss=0.054931, scaled=0.013733, accumulated=0.013733
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 106/132: loss=0.430416, scaled=0.107604, accumulated=0.121337
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 107/132: loss=2.401691, scaled=0.600423, accumulated=0.721760
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Telephone D...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 108/132: loss=0.022969, scaled=0.005742, accumulated=0.727502
📊 ✅ OPTIMIZATION STEP 27:
    Loss: 0.727502
    LR: 2.43e-05
    Grad norm: 59.250000
    Duration: 0.42s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 109/132: loss=0.001708, scaled=0.000427, accumulated=0.000427
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 110/132: loss=1.110812, scaled=0.277703, accumulated=0.278130
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 111/132: loss=0.007000, scaled=0.001750, accumulated=0.279880
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 112/132: loss=0.007000, scaled=0.001750, accumulated=0.281630
📊 ✅ OPTIMIZATION STEP 28:
    Loss: 0.281630
    LR: 2.39e-05
    Grad norm: 26.625000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 113/132: loss=0.001608, scaled=0.000402, accumulated=0.000402
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 114/132: loss=0.134142, scaled=0.033535, accumulated=0.033938
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 115/132: loss=0.085738, scaled=0.021434, accumulated=0.055372
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 116/132: loss=1.280027, scaled=0.320007, accumulated=0.375379
📊 ✅ OPTIMIZATION STEP 29:
    Loss: 0.375379
    LR: 2.36e-05
    Grad norm: 78.500000
    Duration: 0.45s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 117/132: loss=0.542319, scaled=0.135580, accumulated=0.135580
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 118/132: loss=0.017388, scaled=0.004347, accumulated=0.139927
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 119/132: loss=0.001441, scaled=0.000360, accumulated=0.140287
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 120/132: loss=0.425504, scaled=0.106376, accumulated=0.246663
📊 ✅ OPTIMIZATION STEP 30:
    Loss: 0.246663
    LR: 2.33e-05
    Grad norm: 32.750000
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 30
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-20
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 121/132: loss=0.021875, scaled=0.005469, accumulated=0.005469
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "F...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 122/132: loss=0.000788, scaled=0.000197, accumulated=0.005666
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 123/132: loss=0.001372, scaled=0.000343, accumulated=0.006009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 124/132: loss=2.310713, scaled=0.577678, accumulated=0.583687
📊 ✅ OPTIMIZATION STEP 31:
    Loss: 0.583687
    LR: 2.29e-05
    Grad norm: 38.000000
    Duration: 0.52s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 125/132: loss=0.002967, scaled=0.000742, accumulated=0.000742
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 126/132: loss=0.009593, scaled=0.002398, accumulated=0.003140
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 127/132: loss=7.342973, scaled=1.835743, accumulated=1.838883
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 128/132: loss=0.009865, scaled=0.002466, accumulated=1.841350
📊 ✅ OPTIMIZATION STEP 32:
    Loss: 1.841350
    LR: 2.26e-05
    Grad norm: 84.500000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 129/132: loss=0.000342, scaled=0.000086, accumulated=0.000086
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 130/132: loss=0.697379, scaled=0.174345, accumulated=0.174430
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 131/132: loss=0.797975, scaled=0.199494, accumulated=0.373924
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 132/132: loss=0.007040, scaled=0.001760, accumulated=0.375684
📊 ✅ OPTIMIZATION STEP 33:
    Loss: 0.375684
    LR: 2.22e-05
    Grad norm: 21.375000
    Duration: 0.46s
    Batches accumulated: 4

✅ Epoch 1 completed:
    Average loss: 0.351532
    Duration: 653.6s
    Optimization steps this epoch: 33
    Total optimization steps so far: 33

🔄 === Epoch 2/3 ===
📊 Epoch 2: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Bl...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 9 to 112979
  Loss: 1.032895
🔄 Batch 1/132: loss=1.032895, scaled=0.258224, accumulated=0.258224
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 9 to 112979
  Loss: 0.639780
🔄 Batch 2/132: loss=0.639780, scaled=0.159945, accumulated=0.418169
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 9 to 112979
  Loss: 0.026753
🔄 Batch 3/132: loss=0.026753, scaled=0.006688, accumulated=0.424857
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 4/132: loss=0.381446, scaled=0.095361, accumulated=0.520219
📊 ✅ OPTIMIZATION STEP 34:
    Loss: 0.520219
    LR: 2.19e-05
    Grad norm: 31.875000
    Duration: 0.46s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 5/132: loss=0.079061, scaled=0.019765, accumulated=0.019765
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Onli...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 122357
🔄 Batch 6/132: loss=2.067545, scaled=0.516886, accumulated=0.536652
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 7/132: loss=0.408468, scaled=0.102117, accumulated=0.638769
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 8/132: loss=0.079061, scaled=0.019765, accumulated=0.658534
📊 ✅ OPTIMIZATION STEP 35:
    Loss: 0.658534
    LR: 2.16e-05
    Grad norm: 181.000000
    Duration: 0.53s
    Batches accumulated: 4
💾 Saving checkpoint at step 35
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-25
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 9/132: loss=0.000115, scaled=0.000029, accumulated=0.000029
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "D...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 10/132: loss=0.000115, scaled=0.000029, accumulated=0.000058
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 11/132: loss=0.008269, scaled=0.002067, accumulated=0.002125
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 12/132: loss=0.025585, scaled=0.006396, accumulated=0.008521
📊 ✅ OPTIMIZATION STEP 36:
    Loss: 0.008521
    LR: 2.12e-05
    Grad norm: 2.609375
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 13/132: loss=0.000027, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 14/132: loss=0.000022, scaled=0.000006, accumulated=0.000012
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "F...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 15/132: loss=0.000066, scaled=0.000017, accumulated=0.000029
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 16/132: loss=0.861119, scaled=0.215280, accumulated=0.215309
📊 ✅ OPTIMIZATION STEP 37:
    Loss: 0.215309
    LR: 2.09e-05
    Grad norm: 21.500000
    Duration: 0.45s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 17/132: loss=0.727570, scaled=0.181892, accumulated=0.181892
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 18/132: loss=0.000051, scaled=0.000013, accumulated=0.181905
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 19/132: loss=0.000123, scaled=0.000031, accumulated=0.181936
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 20/132: loss=0.433931, scaled=0.108483, accumulated=0.290419
📊 ✅ OPTIMIZATION STEP 38:
    Loss: 0.290419
    LR: 2.06e-05
    Grad norm: 9.125000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 21/132: loss=0.109710, scaled=0.027428, accumulated=0.027428
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 22/132: loss=0.109710, scaled=0.027428, accumulated=0.054855
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 23/132: loss=0.924299, scaled=0.231075, accumulated=0.285930
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 24/132: loss=0.001178, scaled=0.000294, accumulated=0.286224
📊 ✅ OPTIMIZATION STEP 39:
    Loss: 0.286224
    LR: 2.02e-05
    Grad norm: 13.812500
    Duration: 0.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 25/132: loss=0.000046, scaled=0.000011, accumulated=0.000011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 26/132: loss=0.000951, scaled=0.000238, accumulated=0.000249
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 27/132: loss=0.003032, scaled=0.000758, accumulated=0.001007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 28/132: loss=0.000039, scaled=0.000010, accumulated=0.001017
📊 ✅ OPTIMIZATION STEP 40:
    Loss: 0.001017
    LR: 1.99e-05
    Grad norm: 1.640625
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 40
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-30
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 29/132: loss=0.000888, scaled=0.000222, accumulated=0.000222
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 30/132: loss=0.003912, scaled=0.000978, accumulated=0.001200
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 31/132: loss=0.000030, scaled=0.000007, accumulated=0.001207
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 32/132: loss=0.000888, scaled=0.000222, accumulated=0.001429
📊 ✅ OPTIMIZATION STEP 41:
    Loss: 0.001429
    LR: 1.96e-05
    Grad norm: 0.255859
    Duration: 0.71s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 33/132: loss=0.000042, scaled=0.000011, accumulated=0.000011
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 34/132: loss=0.000854, scaled=0.000213, accumulated=0.000224
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 35/132: loss=1.939625, scaled=0.484906, accumulated=0.485130
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 79068
🔄 Batch 36/132: loss=0.873430, scaled=0.218357, accumulated=0.703488
📊 ✅ OPTIMIZATION STEP 42:
    Loss: 0.703488
    LR: 1.92e-05
    Grad norm: 51.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 37/132: loss=0.001158, scaled=0.000289, accumulated=0.000289
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 38/132: loss=1.138066, scaled=0.284517, accumulated=0.284806
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 39/132: loss=0.887985, scaled=0.221996, accumulated=0.506802
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 40/132: loss=0.322701, scaled=0.080675, accumulated=0.587477
📊 ✅ OPTIMIZATION STEP 43:
    Loss: 0.587477
    LR: 1.89e-05
    Grad norm: 28.250000
    Duration: 0.56s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 41/132: loss=0.000104, scaled=0.000026, accumulated=0.000026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 42/132: loss=0.000026, scaled=0.000006, accumulated=0.000032
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 43/132: loss=0.283060, scaled=0.070765, accumulated=0.070797
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 44/132: loss=0.930238, scaled=0.232560, accumulated=0.303357
📊 ✅ OPTIMIZATION STEP 44:
    Loss: 0.303357
    LR: 1.85e-05
    Grad norm: 118.500000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 45/132: loss=0.902364, scaled=0.225591, accumulated=0.225591
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 46/132: loss=0.725281, scaled=0.181320, accumulated=0.406911
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 47/132: loss=1.240124, scaled=0.310031, accumulated=0.716943
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 48/132: loss=2.073255, scaled=0.518314, accumulated=1.235256
📊 ✅ OPTIMIZATION STEP 45:
    Loss: 1.235256
    LR: 1.82e-05
    Grad norm: 66.000000
    Duration: 0.44s
    Batches accumulated: 4
💾 Saving checkpoint at step 45
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-35
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 49/132: loss=2.503206, scaled=0.625802, accumulated=0.625802
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 50/132: loss=0.026107, scaled=0.006527, accumulated=0.632328
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 51/132: loss=0.088028, scaled=0.022007, accumulated=0.654335
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 52/132: loss=0.820244, scaled=0.205061, accumulated=0.859396
📊 ✅ OPTIMIZATION STEP 46:
    Loss: 0.859396
    LR: 1.79e-05
    Grad norm: 42.500000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 53/132: loss=0.851651, scaled=0.212913, accumulated=0.212913
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 54/132: loss=0.000104, scaled=0.000026, accumulated=0.212939
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 55/132: loss=0.990972, scaled=0.247743, accumulated=0.460682
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 56/132: loss=1.135867, scaled=0.283967, accumulated=0.744648
📊 ✅ OPTIMIZATION STEP 47:
    Loss: 0.744648
    LR: 1.75e-05
    Grad norm: 145.000000
    Duration: 0.54s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 57/132: loss=2.801473, scaled=0.700368, accumulated=0.700368
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ph...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 58/132: loss=2.446070, scaled=0.611518, accumulated=1.311886
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 59/132: loss=0.000273, scaled=0.000068, accumulated=1.311954
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 60/132: loss=0.000055, scaled=0.000014, accumulated=1.311968
📊 ✅ OPTIMIZATION STEP 48:
    Loss: 1.311968
    LR: 1.72e-05
    Grad norm: 1808.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 61/132: loss=0.003196, scaled=0.000799, accumulated=0.000799
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 62/132: loss=1.201512, scaled=0.300378, accumulated=0.301177
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 96545
🔄 Batch 63/132: loss=0.334069, scaled=0.083517, accumulated=0.384694
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 64/132: loss=0.003196, scaled=0.000799, accumulated=0.385493
📊 ✅ OPTIMIZATION STEP 49:
    Loss: 0.385493
    LR: 1.69e-05
    Grad norm: 36.250000
    Duration: 0.46s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Smis...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 65/132: loss=0.002498, scaled=0.000625, accumulated=0.000625
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 66/132: loss=0.679531, scaled=0.169883, accumulated=0.170507
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 67/132: loss=0.000291, scaled=0.000073, accumulated=0.170580
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Un...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 68/132: loss=1.298069, scaled=0.324517, accumulated=0.495097
📊 ✅ OPTIMIZATION STEP 50:
    Loss: 0.495097
    LR: 1.65e-05
    Grad norm: 43.750000
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 50
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-40
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 69/132: loss=0.689054, scaled=0.172263, accumulated=0.172263
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 70/132: loss=0.000795, scaled=0.000199, accumulated=0.172462
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 71/132: loss=0.070480, scaled=0.017620, accumulated=0.190082
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 72/132: loss=0.070480, scaled=0.017620, accumulated=0.207702
📊 ✅ OPTIMIZATION STEP 51:
    Loss: 0.207702
    LR: 1.62e-05
    Grad norm: 11.812500
    Duration: 0.46s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 73/132: loss=0.010606, scaled=0.002651, accumulated=0.002651
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 74/132: loss=0.484166, scaled=0.121042, accumulated=0.123693
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 75/132: loss=0.018959, scaled=0.004740, accumulated=0.128433
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 76/132: loss=0.000067, scaled=0.000017, accumulated=0.128449
📊 ✅ OPTIMIZATION STEP 52:
    Loss: 0.128449
    LR: 1.58e-05
    Grad norm: 22.375000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 77/132: loss=0.418037, scaled=0.104509, accumulated=0.104509
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 78/132: loss=0.002752, scaled=0.000688, accumulated=0.105197
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 79/132: loss=0.641791, scaled=0.160448, accumulated=0.265645
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 80/132: loss=0.000537, scaled=0.000134, accumulated=0.265779
📊 ✅ OPTIMIZATION STEP 53:
    Loss: 0.265779
    LR: 1.55e-05
    Grad norm: 22.625000
    Duration: 0.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 81/132: loss=0.000639, scaled=0.000160, accumulated=0.000160
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 82/132: loss=0.278659, scaled=0.069665, accumulated=0.069825
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 83/132: loss=0.000019, scaled=0.000005, accumulated=0.069829
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 84/132: loss=0.000019, scaled=0.000005, accumulated=0.069834
📊 ✅ OPTIMIZATION STEP 54:
    Loss: 0.069834
    LR: 1.52e-05
    Grad norm: 14.625000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 85/132: loss=0.000475, scaled=0.000119, accumulated=0.000119
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 86/132: loss=0.000440, scaled=0.000110, accumulated=0.000229
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 87/132: loss=0.992442, scaled=0.248111, accumulated=0.248339
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 88/132: loss=0.000018, scaled=0.000004, accumulated=0.248344
📊 ✅ OPTIMIZATION STEP 55:
    Loss: 0.248344
    LR: 1.48e-05
    Grad norm: 8.250000
    Duration: 0.45s
    Batches accumulated: 4
💾 Saving checkpoint at step 55
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-45
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 89/132: loss=0.000261, scaled=0.000065, accumulated=0.000065
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 90/132: loss=1.046997, scaled=0.261749, accumulated=0.261815
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 91/132: loss=0.367241, scaled=0.091810, accumulated=0.353625
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 92/132: loss=0.008766, scaled=0.002191, accumulated=0.355816
📊 ✅ OPTIMIZATION STEP 56:
    Loss: 0.355816
    LR: 1.45e-05
    Grad norm: 39.250000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 93/132: loss=0.000256, scaled=0.000064, accumulated=0.000064
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 94/132: loss=1.163508, scaled=0.290877, accumulated=0.290941
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 95/132: loss=0.000667, scaled=0.000167, accumulated=0.291108
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 96/132: loss=0.000330, scaled=0.000083, accumulated=0.291190
📊 ✅ OPTIMIZATION STEP 57:
    Loss: 0.291190
    LR: 1.42e-05
    Grad norm: 55.250000
    Duration: 0.43s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 97/132: loss=0.000193, scaled=0.000048, accumulated=0.000048
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 98/132: loss=1.197607, scaled=0.299402, accumulated=0.299450
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 99/132: loss=0.000019, scaled=0.000005, accumulated=0.299455
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 100/132: loss=0.136652, scaled=0.034163, accumulated=0.333618
📊 ✅ OPTIMIZATION STEP 58:
    Loss: 0.333618
    LR: 1.38e-05
    Grad norm: 38.750000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 101/132: loss=0.001921, scaled=0.000480, accumulated=0.000480
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 102/132: loss=0.267389, scaled=0.066847, accumulated=0.067328
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 103/132: loss=0.000018, scaled=0.000005, accumulated=0.067332
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 104/132: loss=0.000018, scaled=0.000005, accumulated=0.067337
📊 ✅ OPTIMIZATION STEP 59:
    Loss: 0.067337
    LR: 1.35e-05
    Grad norm: 11.375000
    Duration: 0.44s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 105/132: loss=0.825214, scaled=0.206304, accumulated=0.206304
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 106/132: loss=0.001719, scaled=0.000430, accumulated=0.206733
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 107/132: loss=0.345978, scaled=0.086494, accumulated=0.293228
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 108/132: loss=0.000019, scaled=0.000005, accumulated=0.293232
📊 ✅ OPTIMIZATION STEP 60:
    Loss: 0.293232
    LR: 1.31e-05
    Grad norm: 13.062500
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 60
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-50
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 109/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 110/132: loss=0.110353, scaled=0.027588, accumulated=0.027593
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 111/132: loss=0.000145, scaled=0.000036, accumulated=0.027629
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 112/132: loss=0.506765, scaled=0.126691, accumulated=0.154320
📊 ✅ OPTIMIZATION STEP 61:
    Loss: 0.154320
    LR: 1.28e-05
    Grad norm: 11.750000
    Duration: 0.89s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Inve...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 113/132: loss=0.000605, scaled=0.000151, accumulated=0.000151
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 114/132: loss=1.709528, scaled=0.427382, accumulated=0.427533
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 115/132: loss=0.500835, scaled=0.125209, accumulated=0.552742
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 116/132: loss=0.255221, scaled=0.063805, accumulated=0.616547
📊 ✅ OPTIMIZATION STEP 62:
    Loss: 0.616547
    LR: 1.25e-05
    Grad norm: 58.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 117/132: loss=0.000082, scaled=0.000021, accumulated=0.000021
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 118/132: loss=0.326335, scaled=0.081584, accumulated=0.081604
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Telephone D...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 119/132: loss=0.000072, scaled=0.000018, accumulated=0.081622
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 120/132: loss=0.089949, scaled=0.022487, accumulated=0.104109
📊 ✅ OPTIMIZATION STEP 63:
    Loss: 0.104109
    LR: 1.21e-05
    Grad norm: 11.812500
    Duration: 0.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 121/132: loss=0.000059, scaled=0.000015, accumulated=0.000015
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Co...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 122/132: loss=0.711024, scaled=0.177756, accumulated=0.177771
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 123/132: loss=0.586047, scaled=0.146512, accumulated=0.324283
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 124/132: loss=0.000019, scaled=0.000005, accumulated=0.324288
📊 ✅ OPTIMIZATION STEP 64:
    Loss: 0.324288
    LR: 1.18e-05
    Grad norm: 11.000000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 125/132: loss=0.000129, scaled=0.000032, accumulated=0.000032
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AI...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 126/132: loss=0.956641, scaled=0.239160, accumulated=0.239193
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 127/132: loss=4.204101, scaled=1.051025, accumulated=1.290218
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 128/132: loss=0.232412, scaled=0.058103, accumulated=1.348321
📊 ✅ OPTIMIZATION STEP 65:
    Loss: 1.348321
    LR: 1.15e-05
    Grad norm: 55.750000
    Duration: 0.67s
    Batches accumulated: 4
💾 Saving checkpoint at step 65
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-55
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 129/132: loss=1.804918, scaled=0.451229, accumulated=0.451229
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "UA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 130/132: loss=0.000124, scaled=0.000031, accumulated=0.451260
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 131/132: loss=1.804918, scaled=0.451229, accumulated=0.902490
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 132/132: loss=0.232956, scaled=0.058239, accumulated=0.960729
📊 ✅ OPTIMIZATION STEP 66:
    Loss: 0.960729
    LR: 1.11e-05
    Grad norm: 73.500000
    Duration: 0.18s
    Batches accumulated: 4

✅ Epoch 2 completed:
    Average loss: 0.108920
    Duration: 687.5s
    Optimization steps this epoch: 33
    Total optimization steps so far: 66

🔄 === Epoch 3/3 ===
📊 Epoch 3: Processing 132 batches...
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔍 Batch 1 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 79068
  Loss: 0.000040
🔄 Batch 1/132: loss=0.000040, scaled=0.000010, accumulated=0.000010
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Un...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔍 Batch 2 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 94124
  Loss: 0.266136
🔄 Batch 2/132: loss=0.266136, scaled=0.066534, accumulated=0.066544
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔍 Batch 3 debug:
  Batch keys: ['input_ids', 'attention_mask', 'labels']
  input_ids shape: torch.Size([1, 512])
  input_ids device: cpu
  Token ID range: 11 to 94124
  Loss: 1.363859
🔄 Batch 3/132: loss=1.363859, scaled=0.340965, accumulated=0.407509
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 4/132: loss=0.000103, scaled=0.000026, accumulated=0.407535
📊 ✅ OPTIMIZATION STEP 67:
    Loss: 0.407535
    LR: 1.08e-05
    Grad norm: 29.750000
    Duration: 0.43s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 5/132: loss=0.000037, scaled=0.000009, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 6/132: loss=0.000642, scaled=0.000160, accumulated=0.000170
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "D...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 7/132: loss=0.000018, scaled=0.000004, accumulated=0.000174
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 8/132: loss=0.173561, scaled=0.043390, accumulated=0.043564
📊 ✅ OPTIMIZATION STEP 68:
    Loss: 0.043564
    LR: 1.04e-05
    Grad norm: 6.031250
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 9/132: loss=0.322306, scaled=0.080576, accumulated=0.080576
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 10/132: loss=0.146206, scaled=0.036552, accumulated=0.117128
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 11/132: loss=1.060092, scaled=0.265023, accumulated=0.382151
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 12/132: loss=0.000040, scaled=0.000010, accumulated=0.382161
📊 ✅ OPTIMIZATION STEP 69:
    Loss: 0.382161
    LR: 1.01e-05
    Grad norm: 21.625000
    Duration: 0.42s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 13/132: loss=0.000019, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 14/132: loss=0.000087, scaled=0.000022, accumulated=0.000027
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 15/132: loss=0.000019, scaled=0.000005, accumulated=0.000031
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 16/132: loss=0.000019, scaled=0.000005, accumulated=0.000036
📊 ✅ OPTIMIZATION STEP 70:
    Loss: 0.000036
    LR: 9.78e-06
    Grad norm: 0.017090
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 70
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-60
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 17/132: loss=0.002021, scaled=0.000505, accumulated=0.000505
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 18/132: loss=0.000017, scaled=0.000004, accumulated=0.000509
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "F...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 19/132: loss=0.000017, scaled=0.000004, accumulated=0.000514
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "UA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 20/132: loss=0.000070, scaled=0.000018, accumulated=0.000531
📊 ✅ OPTIMIZATION STEP 71:
    Loss: 0.000531
    LR: 9.44e-06
    Grad norm: 0.186523
    Duration: 0.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 21/132: loss=0.001708, scaled=0.000427, accumulated=0.000427
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 22/132: loss=0.058109, scaled=0.014527, accumulated=0.014954
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 79068
🔄 Batch 23/132: loss=0.677702, scaled=0.169426, accumulated=0.184380
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 24/132: loss=0.000035, scaled=0.000009, accumulated=0.184389
📊 ✅ OPTIMIZATION STEP 72:
    Loss: 0.184389
    LR: 9.10e-06
    Grad norm: 12.875000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 25/132: loss=0.000053, scaled=0.000013, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "No...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 26/132: loss=1.082245, scaled=0.270561, accumulated=0.270574
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 27/132: loss=1.250955, scaled=0.312739, accumulated=0.583313
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 28/132: loss=1.082245, scaled=0.270561, accumulated=0.853875
📊 ✅ OPTIMIZATION STEP 73:
    Loss: 0.853875
    LR: 8.76e-06
    Grad norm: 44.750000
    Duration: 0.48s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 29/132: loss=0.017756, scaled=0.004439, accumulated=0.004439
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 30/132: loss=1.051834, scaled=0.262959, accumulated=0.267398
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 31/132: loss=0.000035, scaled=0.000009, accumulated=0.267406
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 32/132: loss=0.002787, scaled=0.000697, accumulated=0.268103
📊 ✅ OPTIMIZATION STEP 74:
    Loss: 0.268103
    LR: 8.43e-06
    Grad norm: 15.875000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 33/132: loss=0.000018, scaled=0.000005, accumulated=0.000005
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 34/132: loss=0.000035, scaled=0.000009, accumulated=0.000013
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 35/132: loss=0.004263, scaled=0.001066, accumulated=0.001079
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 36/132: loss=0.863427, scaled=0.215857, accumulated=0.216936
📊 ✅ OPTIMIZATION STEP 75:
    Loss: 0.216936
    LR: 8.09e-06
    Grad norm: 8.500000
    Duration: 0.43s
    Batches accumulated: 4
💾 Saving checkpoint at step 75
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-65
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 37/132: loss=0.000267, scaled=0.000067, accumulated=0.000067
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 38/132: loss=0.000257, scaled=0.000064, accumulated=0.000131
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 39/132: loss=0.486074, scaled=0.121519, accumulated=0.121650
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 40/132: loss=0.863618, scaled=0.215905, accumulated=0.337554
📊 ✅ OPTIMIZATION STEP 76:
    Loss: 0.337554
    LR: 7.75e-06
    Grad norm: 16.625000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 41/132: loss=1.152916, scaled=0.288229, accumulated=0.288229
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 42/132: loss=0.726338, scaled=0.181585, accumulated=0.469813
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 43/132: loss=0.000040, scaled=0.000010, accumulated=0.469823
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 44/132: loss=0.534114, scaled=0.133529, accumulated=0.603352
📊 ✅ OPTIMIZATION STEP 77:
    Loss: 0.603352
    LR: 7.42e-06
    Grad norm: 38.500000
    Duration: 0.44s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 45/132: loss=1.634533, scaled=0.408633, accumulated=0.408633
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 46/132: loss=1.000005, scaled=0.250001, accumulated=0.658635
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Inve...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 47/132: loss=0.000545, scaled=0.000136, accumulated=0.658771
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 48/132: loss=1.948812, scaled=0.487203, accumulated=1.145974
📊 ✅ OPTIMIZATION STEP 78:
    Loss: 1.145974
    LR: 7.08e-06
    Grad norm: 37.250000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 49/132: loss=0.000144, scaled=0.000036, accumulated=0.000036
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 50/132: loss=0.613271, scaled=0.153318, accumulated=0.153354
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 51/132: loss=0.002844, scaled=0.000711, accumulated=0.154065
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 52/132: loss=1.083088, scaled=0.270772, accumulated=0.424837
📊 ✅ OPTIMIZATION STEP 79:
    Loss: 0.424837
    LR: 6.74e-06
    Grad norm: 97.500000
    Duration: 0.44s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 3. HASE Suspect
| 3.HASE Suspect | Unnamed: 1 |...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Onli...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 122357
🔄 Batch 53/132: loss=0.034459, scaled=0.008615, accumulated=0.008615
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 54/132: loss=0.850704, scaled=0.212676, accumulated=0.221291
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 55/132: loss=0.000797, scaled=0.000199, accumulated=0.221490
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 56/132: loss=0.000184, scaled=0.000046, accumulated=0.221536
📊 ✅ OPTIMIZATION STEP 80:
    Loss: 0.221536
    LR: 6.40e-06
    Grad norm: 15.312500
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 80
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-70
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 57/132: loss=0.000035, scaled=0.000009, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "E-...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 58/132: loss=0.609522, scaled=0.152381, accumulated=0.152389
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Ph...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 59/132: loss=0.000040, scaled=0.000010, accumulated=0.152399
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## 4.Victim with financial loss
| 4.Victim with fi...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 8 to 120167
🔄 Batch 60/132: loss=0.000282, scaled=0.000071, accumulated=0.152470
📊 ✅ OPTIMIZATION STEP 81:
    Loss: 0.152470
    LR: 6.07e-06
    Grad norm: 9.062500
    Duration: 0.40s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 61/132: loss=0.032146, scaled=0.008036, accumulated=0.008036
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 62/132: loss=0.000075, scaled=0.000019, accumulated=0.008055
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 63/132: loss=0.002113, scaled=0.000528, accumulated=0.008583
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 64/132: loss=0.000259, scaled=0.000065, accumulated=0.008648
📊 ✅ OPTIMIZATION STEP 82:
    Loss: 0.008648
    LR: 5.73e-06
    Grad norm: 1.851562
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 65/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 66/132: loss=0.000185, scaled=0.000046, accumulated=0.000051
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'Page x of y

URP-0000000001 - Original Case Reques...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 67/132: loss=0.000185, scaled=0.000046, accumulated=0.000097
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 68/132: loss=0.000068, scaled=0.000017, accumulated=0.000114
📊 ✅ OPTIMIZATION STEP 83:
    Loss: 0.000114
    LR: 5.39e-06
    Grad norm: 0.045654
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 69/132: loss=0.000038, scaled=0.000009, accumulated=0.000009
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 70/132: loss=0.641231, scaled=0.160308, accumulated=0.160317
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Pu...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 71/132: loss=0.000037, scaled=0.000009, accumulated=0.160327
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 72/132: loss=0.000032, scaled=0.000008, accumulated=0.160335
📊 ✅ OPTIMIZATION STEP 84:
    Loss: 0.160335
    LR: 5.06e-06
    Grad norm: 13.375000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 73/132: loss=0.000030, scaled=0.000007, accumulated=0.000007
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 74/132: loss=0.000030, scaled=0.000007, accumulated=0.000015
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 75/132: loss=0.000017, scaled=0.000004, accumulated=0.000019
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 4.Victim with financial los...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Smis...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 76/132: loss=0.000575, scaled=0.000144, accumulated=0.000163
📊 ✅ OPTIMIZATION STEP 85:
    Loss: 0.000163
    LR: 4.72e-06
    Grad norm: 0.061035
    Duration: 0.40s
    Batches accumulated: 4
💾 Saving checkpoint at step 85
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-75
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 77/132: loss=0.001972, scaled=0.000493, accumulated=0.000493
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 78/132: loss=0.896763, scaled=0.224191, accumulated=0.224684
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 79/132: loss=0.692364, scaled=0.173091, accumulated=0.397775
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 80/132: loss=0.590124, scaled=0.147531, accumulated=0.545306
📊 ✅ OPTIMIZATION STEP 86:
    Loss: 0.545306
    LR: 4.38e-06
    Grad norm: 21.875000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 81/132: loss=0.460056, scaled=0.115014, accumulated=0.115014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 82/132: loss=0.697346, scaled=0.174336, accumulated=0.289350
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 83/132: loss=0.408233, scaled=0.102058, accumulated=0.391409
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 84/132: loss=0.001685, scaled=0.000421, accumulated=0.391830
📊 ✅ OPTIMIZATION STEP 87:
    Loss: 0.391830
    LR: 4.04e-06
    Grad norm: 15.187500
    Duration: 0.51s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 85/132: loss=0.000069, scaled=0.000017, accumulated=0.000017
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 86/132: loss=0.000029, scaled=0.000007, accumulated=0.000024
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 87/132: loss=0.000759, scaled=0.000190, accumulated=0.000214
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 88/132: loss=0.000029, scaled=0.000007, accumulated=0.000222
📊 ✅ OPTIMIZATION STEP 88:
    Loss: 0.000222
    LR: 3.71e-06
    Grad norm: 0.074219
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Ro...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 89/132: loss=0.449712, scaled=0.112428, accumulated=0.112428
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 90/132: loss=0.048843, scaled=0.012211, accumulated=0.124639
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 91/132: loss=0.434233, scaled=0.108558, accumulated=0.233197
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 92/132: loss=0.600574, scaled=0.150144, accumulated=0.383341
📊 ✅ OPTIMIZATION STEP 89:
    Loss: 0.383341
    LR: 3.37e-06
    Grad norm: 15.687500
    Duration: 0.49s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 96545
🔄 Batch 93/132: loss=0.792733, scaled=0.198183, accumulated=0.198183
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 94/132: loss=0.127372, scaled=0.031843, accumulated=0.230026
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 95/132: loss=0.000029, scaled=0.000007, accumulated=0.230033
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Soci...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Social Medi...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 96/132: loss=0.165628, scaled=0.041407, accumulated=0.271440
📊 ✅ OPTIMIZATION STEP 90:
    Loss: 0.271440
    LR: 3.03e-06
    Grad norm: 26.125000
    Duration: 0.18s
    Batches accumulated: 4
💾 Saving checkpoint at step 90
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-80
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 97/132: loss=0.000017, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 98/132: loss=0.000038, scaled=0.000010, accumulated=0.000014
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 99/132: loss=0.001416, scaled=0.000354, accumulated=0.000368
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AI...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 100/132: loss=0.970884, scaled=0.242721, accumulated=0.243089
📊 ✅ OPTIMIZATION STEP 91:
    Loss: 0.243089
    LR: 2.70e-06
    Grad norm: 26.750000
    Duration: 0.44s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 101/132: loss=0.003761, scaled=0.000940, accumulated=0.000940
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 102/132: loss=0.009103, scaled=0.002276, accumulated=0.003216
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 103/132: loss=0.494183, scaled=0.123546, accumulated=0.126762
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 104/132: loss=0.000941, scaled=0.000235, accumulated=0.126997
📊 ✅ OPTIMIZATION STEP 92:
    Loss: 0.126997
    LR: 2.36e-06
    Grad norm: 8.937500
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Tele...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Telephone D...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 105/132: loss=0.000073, scaled=0.000018, accumulated=0.000018
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "In...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 106/132: loss=0.415199, scaled=0.103800, accumulated=0.103818
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 107/132: loss=0.000018, scaled=0.000004, accumulated=0.103822
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Victim ODFT case. E...'
  Input: '## Scenario
|
|  |

## 3. HASE Suspect
| 3.HASE Su...'
  Output: '{
  "source": "Victim ODFT",
  "fraud_type": "Impe...'
  Full text: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Prompt only: 'Instruction: You are given the content of a Victim ODFT case. Extract and summarize the information ...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 122357
🔄 Batch 108/132: loss=0.000485, scaled=0.000121, accumulated=0.103944
📊 ✅ OPTIMIZATION STEP 93:
    Loss: 0.103944
    LR: 2.02e-06
    Grad norm: 7.656250
    Duration: 0.50s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 109/132: loss=0.000018, scaled=0.000004, accumulated=0.000004
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 110/132: loss=0.622337, scaled=0.155584, accumulated=0.155589
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 111/132: loss=0.001566, scaled=0.000392, accumulated=0.155980
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 112/132: loss=0.000027, scaled=0.000007, accumulated=0.155987
📊 ✅ OPTIMIZATION STEP 94:
    Loss: 0.155987
    LR: 1.69e-06
    Grad norm: 23.250000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 113/132: loss=0.001400, scaled=0.000350, accumulated=0.000350
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an ADCC case. Extract...'
  Input: 'Dear HSB,

Please be informed of a case of **"Inve...'
  Output: '{
  "source": "ADCC",
  "fraud_type": "Investment ...'
  Full text: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Prompt only: 'Instruction: You are given the content of an ADCC case. Extract and summarize the information into J...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 1 to 112979
🔄 Batch 114/132: loss=0.044190, scaled=0.011047, accumulated=0.011397
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 115/132: loss=0.000706, scaled=0.000177, accumulated=0.011574
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 116/132: loss=0.000028, scaled=0.000007, accumulated=0.011581
📊 ✅ OPTIMIZATION STEP 95:
    Loss: 0.011581
    LR: 1.35e-06
    Grad norm: 1.648438
    Duration: 0.39s
    Batches accumulated: 4
💾 Saving checkpoint at step 95
🗑️ Removing old checkpoint: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/checkpoint-85
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "Im...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 94124
🔄 Batch 117/132: loss=0.424897, scaled=0.106224, accumulated=0.106224
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 118/132: loss=0.000782, scaled=0.000196, accumulated=0.106420
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 119/132: loss=0.000026, scaled=0.000007, accumulated=0.106426
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 120/132: loss=0.000038, scaled=0.000009, accumulated=0.106436
📊 ✅ OPTIMIZATION STEP 96:
    Loss: 0.106436
    LR: 1.01e-06
    Grad norm: 11.625000
    Duration: 0.19s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Em...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 121/132: loss=0.947426, scaled=0.236857, accumulated=0.236857
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an Internal Referral ...'
  Input: 'FC-UAR document
Page x of y

URP-0000000001 - Orig...'
  Output: '{
  "source": "Internal Referral",
  "fraud_type":...'
  Full text: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Prompt only: 'Instruction: You are given the content of an Internal Referral case. Extract and summarize the infor...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 122/132: loss=0.000028, scaled=0.000007, accumulated=0.236864
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 123/132: loss=0.000017, scaled=0.000004, accumulated=0.236868
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "HA...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 124/132: loss=0.352790, scaled=0.088198, accumulated=0.325065
📊 ✅ OPTIMIZATION STEP 97:
    Loss: 0.325065
    LR: 6.74e-07
    Grad norm: 13.750000
    Duration: 0.42s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Bl...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 125/132: loss=0.877122, scaled=0.219281, accumulated=0.219281
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Te...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 126/132: loss=0.477760, scaled=0.119440, accumulated=0.338721
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 127/132: loss=0.000683, scaled=0.000171, accumulated=0.338891
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 128/132: loss=0.000017, scaled=0.000004, accumulated=0.338896
📊 ✅ OPTIMIZATION STEP 98:
    Loss: 0.338896
    LR: 3.37e-07
    Grad norm: 10.750000
    Duration: 0.18s
    Batches accumulated: 4
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of an HSBC Referral case...'
  Input: 'Dear team,

There is a fraud case reporting involv...'
  Output: '{
  "source": "HSBC Referral",
  "fraud_type": "AP...'
  Full text: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of an HSBC Referral case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 129/132: loss=0.000668, scaled=0.000167, accumulated=0.000167
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 130/132: loss=0.000019, scaled=0.000005, accumulated=0.000172
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Search Warrant case...'
  Input: 'Police Force Ordinance
(Cap. 232)

Contact Person:...'
  Output: '{
  "source": "Search Warrant",
  "fraud_type": "O...'
  Full text: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Prompt only: 'Instruction: You are given the content of a Search Warrant case. Extract and summarize the informati...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 11 to 79068
🔄 Batch 131/132: loss=0.000019, scaled=0.000005, accumulated=0.000176
🔍 Processing item 1:
  Type: <class 'dict'>
  Keys: ['Instruction', 'Input', 'Output']
  Instruction: 'You are given the content of a Police Letter case....'
  Input: '**<u>Annex H6</u>**
**PERSONAL DATA**
*Our Ref.:* ...'
  Output: '{
  "source": "Police Letter",
  "fraud_type": "Co...'
  Full text: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Prompt only: 'Instruction: You are given the content of a Police Letter case. Extract and summarize the informatio...'
  Kept last 5 tokens as labels
  Final sequence length: 512
  Valid labels: 5
✅ Successfully processed 1 items in batch
📊 Final batch shape: torch.Size([1, 512])
📊 Token ID range: 9 to 112979
🔄 Batch 132/132: loss=0.526752, scaled=0.131688, accumulated=0.131864
📊 ✅ OPTIMIZATION STEP 99:
    Loss: 0.131864
    LR: 0.00e+00
    Grad norm: 7.625000
    Duration: 0.55s
    Batches accumulated: 4

✅ Epoch 3 completed:
    Average loss: 0.064758
    Duration: 590.9s
    Optimization steps this epoch: 33
    Total optimization steps so far: 99

🎉 Training completed! Total optimization steps: 99
💾 Saving final model...
✅ Model saved to ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT
🎉 Training and saving completed successfully!

🔍 Final GPU memory state:
GPU Memory Usage:
  GPU 0: 22.65GB allocated, 23.19GB reserved
  GPU 1: 22.53GB allocated, 23.29GB reserved

================================================================================
📊 COMPREHENSIVE TRAINING METRICS REPORT
================================================================================

🎯 TRAINING OVERVIEW
----------------------------------------
📅 Total Training Time: 0:34:15
🔢 Total Training Steps: 99
⚡ Average Step Duration: 0.348 seconds
🚀 Steps per Second: 2.87
📈 Initial Loss: 1.3749
🏁 Final Loss: 0.1319
🎯 Best Loss: 0.0000
📉 Loss Improvement: 1.2430
📊 Loss Improvement: 90.41%

⏱️  STEP TIMING BREAKDOWN
----------------------------------------
🔧 total_training: 34m 15.7s
🔧 data_loading: 0m 0.6s
🔧 model_loading: 0m 3.8s
🔧 lora_setup: 0m 0.0s
🔧 training_setup: 0m 0.0s
🔧 training_loop: 32m 13.2s
🔧 model_saving: 1m 56.5s

💻 RESOURCE UTILIZATION
----------------------------------------
🖥️  Peak CPU Usage: 4.2%
📊 Average CPU Usage: 1.0%

🎮 GPU Memory Usage:
  GPU 0: 22.65 GB (peak)
  GPU 1: 22.53 GB (peak)

💾 Disk I/O:
  📖 Read: 0.10 GB
  📝 Write: 0.21 GB
  📊 Total: 0.31 GB
================================================================================
📊 Detailed metrics saved to: ./output_models/job_20250528_1700_llama_Llama3.1-8B-Instruct_FullFT/training_metrics

==================================================
🎉 MODEL PARALLEL TRAINING COMPLETED SUCCESSFULLY!
==================================================

==================================================
STARTING CLEANUP PROCESS
==================================================
Closing TensorBoard writer...
Clearing model...
Cleanup completed!
==================================================
🧹 All cleanup completed. Exiting.

Program exiting normally...

==================================================
STARTING CLEANUP PROCESS
==================================================
Cleanup completed!
==================================================
Found 0 child processes to terminate
